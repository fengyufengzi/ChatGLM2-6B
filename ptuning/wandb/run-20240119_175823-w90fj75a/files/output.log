/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[INFO|trainer.py:1786] 2024-01-19 17:58:29,075 >> ***** Running training *****
[INFO|trainer.py:1787] 2024-01-19 17:58:29,075 >>   Num examples = 5,725
[INFO|trainer.py:1788] 2024-01-19 17:58:29,075 >>   Num Epochs = 15
[INFO|trainer.py:1789] 2024-01-19 17:58:29,075 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:1790] 2024-01-19 17:58:29,075 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:1791] 2024-01-19 17:58:29,075 >>   Gradient Accumulation steps = 16
[INFO|trainer.py:1792] 2024-01-19 17:58:29,075 >>   Total optimization steps = 5,000
[INFO|trainer.py:1793] 2024-01-19 17:58:29,075 >>   Number of trainable parameters = 917,504
[INFO|integrations.py:727] 2024-01-19 17:58:29,102 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|                                                                                                                                         | 0/5000 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
01/19/2024 17:58:29 - WARNING - transformers_modules.chatglm2-6b.modeling_chatglm - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...








  0%|▏                                                                                                                              | 9/5000 [00:41<6:14:09,  4.50s/it]










  0%|▍                                                                                                                             | 19/5000 [01:25<6:12:23,  4.49s/it]










  1%|▋                                                                                                                             | 29/5000 [02:10<6:12:08,  4.49s/it]










  1%|▉                                                                                                                             | 39/5000 [02:55<6:11:22,  4.49s/it]











  1%|█▎                                                                                                                            | 50/5000 [03:45<6:10:32,  4.49s/it]









  1%|█▍                                                                                                                            | 59/5000 [04:25<6:09:49,  4.49s/it]










  1%|█▋                                                                                                                            | 69/5000 [05:10<6:09:08,  4.49s/it]










  2%|█▉                                                                                                                            | 79/5000 [05:55<6:08:19,  4.49s/it]











  2%|██▎                                                                                                                           | 90/5000 [06:44<6:07:31,  4.49s/it]










  2%|██▌                                                                                                                          | 100/5000 [07:29<6:06:46,  4.49s/it]










  2%|██▊                                                                                                                          | 110/5000 [08:14<6:06:01,  4.49s/it]










  2%|███                                                                                                                          | 120/5000 [08:59<6:05:14,  4.49s/it]










  3%|███▎                                                                                                                         | 130/5000 [09:44<6:04:28,  4.49s/it]










  3%|███▌                                                                                                                         | 140/5000 [10:29<6:03:44,  4.49s/it]










  3%|███▊                                                                                                                         | 150/5000 [11:14<6:02:59,  4.49s/it]










  3%|████                                                                                                                         | 160/5000 [11:59<6:02:13,  4.49s/it]










  3%|████▎                                                                                                                        | 170/5000 [12:44<6:01:32,  4.49s/it]










  4%|████▌                                                                                                                        | 180/5000 [13:29<6:00:45,  4.49s/it]










  4%|████▊                                                                                                                        | 190/5000 [14:13<6:00:00,  4.49s/it]










  4%|█████                                                                                                                        | 200/5000 [14:58<5:59:10,  4.49s/it]










  4%|█████▎                                                                                                                       | 210/5000 [15:43<5:58:30,  4.49s/it]










  4%|█████▌                                                                                                                       | 220/5000 [16:28<5:57:52,  4.49s/it]










  5%|█████▊                                                                                                                       | 230/5000 [17:13<5:57:02,  4.49s/it]










  5%|██████                                                                                                                       | 240/5000 [17:58<5:56:16,  4.49s/it]










  5%|██████▎                                                                                                                      | 250/5000 [18:43<5:55:31,  4.49s/it]










  5%|██████▌                                                                                                                      | 260/5000 [19:28<5:54:46,  4.49s/it]










  5%|██████▊                                                                                                                      | 270/5000 [20:13<5:54:05,  4.49s/it]










  6%|███████                                                                                                                      | 280/5000 [20:58<5:53:17,  4.49s/it]










  6%|███████▎                                                                                                                     | 290/5000 [21:43<5:52:36,  4.49s/it]









  6%|███████▍                                                                                                                     | 299/5000 [22:23<5:51:51,  4.49s/it]










  6%|███████▋                                                                                                                     | 309/5000 [23:08<5:51:04,  4.49s/it]










  6%|███████▉                                                                                                                     | 319/5000 [23:53<5:50:18,  4.49s/it]










  7%|████████▏                                                                                                                    | 329/5000 [24:38<5:49:37,  4.49s/it]










  7%|████████▍                                                                                                                    | 339/5000 [25:23<5:48:55,  4.49s/it]










  7%|████████▋                                                                                                                    | 349/5000 [26:08<5:48:07,  4.49s/it]










  7%|████████▉                                                                                                                    | 359/5000 [26:52<5:47:21,  4.49s/it]




  7%|█████████                                                                                                                    | 363/5000 [27:10<5:47:05,  4.49s/it]








  8%|█████████▍                                                                                                                   | 379/5000 [28:22<5:45:52,  4.49s/it]










  8%|█████████▋                                                                                                                   | 389/5000 [29:07<5:45:06,  4.49s/it]










  8%|█████████▉                                                                                                                   | 399/5000 [29:52<5:44:21,  4.49s/it]










  8%|██████████▏                                                                                                                  | 409/5000 [30:37<5:43:37,  4.49s/it]










  8%|██████████▍                                                                                                                  | 419/5000 [31:22<5:42:49,  4.49s/it]










  9%|██████████▋                                                                                                                  | 429/5000 [32:07<5:42:06,  4.49s/it]










  9%|██████████▉                                                                                                                  | 439/5000 [32:52<5:41:20,  4.49s/it]










  9%|███████████▏                                                                                                                 | 449/5000 [33:37<5:40:31,  4.49s/it]










  9%|███████████▍                                                                                                                 | 459/5000 [34:21<5:39:50,  4.49s/it]










  9%|███████████▋                                                                                                                 | 469/5000 [35:06<5:39:07,  4.49s/it]










 10%|███████████▉                                                                                                                 | 479/5000 [35:51<5:38:24,  4.49s/it]










 10%|████████████▏                                                                                                                | 489/5000 [36:36<5:37:38,  4.49s/it]










 10%|████████████▍                                                                                                                | 499/5000 [37:21<5:36:50,  4.49s/it]










 10%|████████████▋                                                                                                                | 509/5000 [38:06<5:36:06,  4.49s/it]










 10%|████████████▉                                                                                                                | 519/5000 [38:51<5:35:23,  4.49s/it]










 11%|█████████████▏                                                                                                               | 529/5000 [39:36<5:34:34,  4.49s/it]










 11%|█████████████▍                                                                                                               | 539/5000 [40:21<5:33:54,  4.49s/it]










 11%|█████████████▋                                                                                                               | 549/5000 [41:06<5:33:09,  4.49s/it]










 11%|█████████████▉                                                                                                               | 559/5000 [41:51<5:32:22,  4.49s/it]










 11%|██████████████▏                                                                                                              | 569/5000 [42:35<5:31:37,  4.49s/it]










 12%|██████████████▍                                                                                                              | 579/5000 [43:20<5:30:52,  4.49s/it]










 12%|██████████████▋                                                                                                              | 589/5000 [44:05<5:30:08,  4.49s/it]










 12%|██████████████▉                                                                                                              | 599/5000 [44:50<5:29:25,  4.49s/it]










 12%|███████████████▏                                                                                                             | 609/5000 [45:35<5:28:40,  4.49s/it]










 12%|███████████████▍                                                                                                             | 619/5000 [46:20<5:27:54,  4.49s/it]










 13%|███████████████▋                                                                                                             | 629/5000 [47:05<5:27:11,  4.49s/it]










 13%|███████████████▉                                                                                                             | 639/5000 [47:50<5:26:25,  4.49s/it]










 13%|████████████████▏                                                                                                            | 649/5000 [48:35<5:25:39,  4.49s/it]










 13%|████████████████▍                                                                                                            | 659/5000 [49:20<5:24:54,  4.49s/it]










 13%|████████████████▋                                                                                                            | 669/5000 [50:05<5:24:09,  4.49s/it]










 14%|████████████████▉                                                                                                            | 679/5000 [50:49<5:23:25,  4.49s/it]










 14%|█████████████████▏                                                                                                           | 689/5000 [51:34<5:22:39,  4.49s/it]










 14%|█████████████████▍                                                                                                           | 699/5000 [52:19<5:21:55,  4.49s/it]










 14%|█████████████████▋                                                                                                           | 709/5000 [53:04<5:21:08,  4.49s/it]










 14%|█████████████████▉                                                                                                           | 719/5000 [53:49<5:20:26,  4.49s/it]










 15%|██████████████████▏                                                                                                          | 729/5000 [54:34<5:19:39,  4.49s/it]










 15%|██████████████████▍                                                                                                          | 739/5000 [55:19<5:18:54,  4.49s/it]










 15%|██████████████████▋                                                                                                          | 749/5000 [56:04<5:18:11,  4.49s/it]










 15%|██████████████████▉                                                                                                          | 759/5000 [56:49<5:17:23,  4.49s/it]










 15%|███████████████████▏                                                                                                         | 769/5000 [57:34<5:16:40,  4.49s/it]










 16%|███████████████████▍                                                                                                         | 779/5000 [58:19<5:15:52,  4.49s/it]










 16%|███████████████████▋                                                                                                         | 789/5000 [59:03<5:15:08,  4.49s/it]










 16%|███████████████████▉                                                                                                         | 799/5000 [59:48<5:14:22,  4.49s/it]










 16%|███████████████████▉                                                                                                       | 809/5000 [1:00:33<5:13:40,  4.49s/it]










 16%|████████████████████▏                                                                                                      | 819/5000 [1:01:18<5:12:52,  4.49s/it]










 17%|████████████████████▍                                                                                                      | 829/5000 [1:02:03<5:12:11,  4.49s/it]










 17%|████████████████████▋                                                                                                      | 839/5000 [1:02:48<5:11:26,  4.49s/it]










 17%|████████████████████▉                                                                                                      | 849/5000 [1:03:33<5:10:39,  4.49s/it]










 17%|█████████████████████▏                                                                                                     | 859/5000 [1:04:18<5:09:54,  4.49s/it]










 17%|█████████████████████▍                                                                                                     | 869/5000 [1:05:03<5:09:05,  4.49s/it]










 18%|█████████████████████▌                                                                                                     | 879/5000 [1:05:48<5:08:24,  4.49s/it]










 18%|█████████████████████▊                                                                                                     | 889/5000 [1:06:32<5:07:38,  4.49s/it]










 18%|██████████████████████                                                                                                     | 899/5000 [1:07:17<5:06:54,  4.49s/it]










 18%|██████████████████████▎                                                                                                    | 909/5000 [1:08:02<5:06:05,  4.49s/it]










 18%|██████████████████████▌                                                                                                    | 919/5000 [1:08:47<5:05:22,  4.49s/it]










 19%|██████████████████████▊                                                                                                    | 929/5000 [1:09:32<5:04:39,  4.49s/it]










 19%|███████████████████████                                                                                                    | 939/5000 [1:10:17<5:03:53,  4.49s/it]










 19%|███████████████████████▎                                                                                                   | 949/5000 [1:11:02<5:03:07,  4.49s/it]










 19%|███████████████████████▌                                                                                                   | 959/5000 [1:11:47<5:02:26,  4.49s/it]










 19%|███████████████████████▊                                                                                                   | 969/5000 [1:12:32<5:01:39,  4.49s/it]










 20%|████████████████████████                                                                                                   | 979/5000 [1:13:17<5:00:51,  4.49s/it]










 20%|████████████████████████▎                                                                                                  | 989/5000 [1:14:01<5:00:09,  4.49s/it]










 20%|████████████████████████▌                                                                                                  | 999/5000 [1:14:46<4:59:25,  4.49s/it]
{'loss': 2.6325, 'learning_rate': 0.0008, 'epoch': 2.79}
 20%|████████████████████████▍                                                                                                 | 1000/5000 [1:14:51<4:59:21,  4.49s/it][INFO|configuration_utils.py:458] 2024-01-19 19:13:20,482 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-3/checkpoint-1000/config.json
[INFO|configuration_utils.py:364] 2024-01-19 19:13:20,482 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-3/checkpoint-1000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-19 19:13:20,485 >> Model weights saved in output/adgen-chatglm2-6b-pt-64-1e-3/checkpoint-1000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-19 19:13:20,485 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-64-1e-3/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-19 19:13:20,486 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-64-1e-3/checkpoint-1000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(








 20%|████████████████████████▌                                                                                                 | 1009/5000 [1:15:31<4:58:41,  4.49s/it]










 20%|████████████████████████▊                                                                                                 | 1019/5000 [1:16:16<4:57:53,  4.49s/it]










 21%|█████████████████████████                                                                                                 | 1029/5000 [1:17:01<4:57:07,  4.49s/it]










 21%|█████████████████████████▎                                                                                                | 1039/5000 [1:17:46<4:56:25,  4.49s/it]










 21%|█████████████████████████▌                                                                                                | 1049/5000 [1:18:31<4:55:41,  4.49s/it]










 21%|█████████████████████████▊                                                                                                | 1059/5000 [1:19:16<4:54:54,  4.49s/it]











 21%|██████████████████████████                                                                                                | 1070/5000 [1:20:05<4:54:06,  4.49s/it]









 22%|██████████████████████████▎                                                                                               | 1079/5000 [1:20:46<4:53:24,  4.49s/it]










 22%|██████████████████████████▌                                                                                               | 1089/5000 [1:21:31<4:52:38,  4.49s/it]










 22%|██████████████████████████▊                                                                                               | 1099/5000 [1:22:15<4:51:54,  4.49s/it]










 22%|███████████████████████████                                                                                               | 1109/5000 [1:23:00<4:51:09,  4.49s/it]










 22%|███████████████████████████▎                                                                                              | 1119/5000 [1:23:45<4:50:27,  4.49s/it]










 23%|███████████████████████████▌                                                                                              | 1129/5000 [1:24:30<4:49:40,  4.49s/it]











 23%|███████████████████████████▊                                                                                              | 1140/5000 [1:25:19<4:48:48,  4.49s/it]









 23%|████████████████████████████                                                                                              | 1149/5000 [1:26:00<4:48:10,  4.49s/it]










 23%|████████████████████████████▎                                                                                             | 1159/5000 [1:26:45<4:47:25,  4.49s/it]










 23%|████████████████████████████▌                                                                                             | 1169/5000 [1:27:30<4:46:40,  4.49s/it]










 24%|████████████████████████████▊                                                                                             | 1179/5000 [1:28:15<4:45:58,  4.49s/it]










 24%|█████████████████████████████                                                                                             | 1189/5000 [1:29:00<4:45:12,  4.49s/it]










 24%|█████████████████████████████▎                                                                                            | 1199/5000 [1:29:44<4:44:25,  4.49s/it]




 24%|█████████████████████████████▎                                                                                            | 1203/5000 [1:30:02<4:44:09,  4.49s/it]