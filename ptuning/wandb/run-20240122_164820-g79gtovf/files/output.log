/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[INFO|trainer.py:1786] 2024-01-22 16:48:27,580 >> ***** Running training *****
[INFO|trainer.py:1787] 2024-01-22 16:48:27,580 >>   Num examples = 5,725
[INFO|trainer.py:1788] 2024-01-22 16:48:27,580 >>   Num Epochs = 9
[INFO|trainer.py:1789] 2024-01-22 16:48:27,580 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:1790] 2024-01-22 16:48:27,580 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:1791] 2024-01-22 16:48:27,580 >>   Gradient Accumulation steps = 16
[INFO|trainer.py:1792] 2024-01-22 16:48:27,580 >>   Total optimization steps = 3,000
[INFO|trainer.py:1793] 2024-01-22 16:48:27,581 >>   Number of trainable parameters = 1,835,008
[INFO|integrations.py:727] 2024-01-22 16:48:27,607 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|                                                                                                    | 0/3000 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
01/22/2024 16:48:27 - WARNING - transformers_modules.chatglm2-6b.modeling_chatglm - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...








  0%|▎                                                                                         | 9/3000 [00:41<3:45:42,  4.53s/it]











  1%|▌                                                                                        | 20/3000 [01:31<3:44:31,  4.52s/it]









  1%|▉                                                                                        | 30/3000 [02:16<3:43:47,  4.52s/it]










  1%|█▏                                                                                       | 40/3000 [03:01<3:43:02,  4.52s/it]










  2%|█▍                                                                                       | 50/3000 [03:46<3:42:19,  4.52s/it]










  2%|█▊                                                                                       | 60/3000 [04:31<3:41:35,  4.52s/it]










  2%|██                                                                                       | 70/3000 [05:17<3:40:46,  4.52s/it]










  3%|██▎                                                                                      | 80/3000 [06:02<3:40:02,  4.52s/it]










  3%|██▋                                                                                      | 90/3000 [06:47<3:39:14,  4.52s/it]










  3%|██▉                                                                                     | 100/3000 [07:32<3:38:31,  4.52s/it]










  4%|███▏                                                                                    | 110/3000 [08:18<3:37:46,  4.52s/it]










  4%|███▌                                                                                    | 120/3000 [09:03<3:37:01,  4.52s/it]










  4%|███▊                                                                                    | 130/3000 [09:48<3:36:15,  4.52s/it]










  5%|████                                                                                    | 140/3000 [10:33<3:35:31,  4.52s/it]










  5%|████▍                                                                                   | 150/3000 [11:18<3:34:45,  4.52s/it]









  5%|████▋                                                                                   | 159/3000 [11:59<3:34:02,  4.52s/it]










  6%|████▉                                                                                   | 169/3000 [12:44<3:33:19,  4.52s/it]










  6%|█████▎                                                                                  | 179/3000 [13:29<3:32:34,  4.52s/it]










  6%|█████▌                                                                                  | 189/3000 [14:15<3:31:50,  4.52s/it]










  7%|█████▊                                                                                  | 199/3000 [15:00<3:31:03,  4.52s/it]










  7%|██████▏                                                                                 | 209/3000 [15:45<3:30:18,  4.52s/it]










  7%|██████▍                                                                                 | 219/3000 [16:30<3:29:33,  4.52s/it]










  8%|██████▋                                                                                 | 229/3000 [17:16<3:28:46,  4.52s/it]










  8%|███████                                                                                 | 239/3000 [18:01<3:28:02,  4.52s/it]










  8%|███████▎                                                                                | 249/3000 [18:46<3:27:19,  4.52s/it]










  9%|███████▌                                                                                | 259/3000 [19:31<3:26:33,  4.52s/it]










  9%|███████▉                                                                                | 269/3000 [20:16<3:25:48,  4.52s/it]










  9%|████████▏                                                                               | 279/3000 [21:02<3:25:03,  4.52s/it]










 10%|████████▍                                                                               | 289/3000 [21:47<3:24:18,  4.52s/it]










 10%|████████▊                                                                               | 299/3000 [22:32<3:23:38,  4.52s/it]










 10%|█████████                                                                               | 309/3000 [23:17<3:22:50,  4.52s/it]










 11%|█████████▎                                                                              | 319/3000 [24:03<3:22:02,  4.52s/it]










 11%|█████████▋                                                                              | 329/3000 [24:48<3:21:16,  4.52s/it]










 11%|█████████▉                                                                              | 339/3000 [25:33<3:20:31,  4.52s/it]










 12%|██████████▏                                                                             | 349/3000 [26:18<3:19:45,  4.52s/it]










 12%|██████████▌                                                                             | 359/3000 [27:03<3:19:01,  4.52s/it]










 12%|██████████▊                                                                             | 369/3000 [27:49<3:18:15,  4.52s/it]










 13%|███████████                                                                             | 379/3000 [28:34<3:17:29,  4.52s/it]










 13%|███████████▍                                                                            | 389/3000 [29:19<3:16:46,  4.52s/it]










 13%|███████████▋                                                                            | 399/3000 [30:04<3:16:00,  4.52s/it]










 14%|███████████▉                                                                            | 409/3000 [30:49<3:15:15,  4.52s/it]










 14%|████████████▎                                                                           | 419/3000 [31:35<3:14:29,  4.52s/it]










 14%|████████████▌                                                                           | 429/3000 [32:20<3:13:44,  4.52s/it]










 15%|████████████▉                                                                           | 439/3000 [33:05<3:12:59,  4.52s/it]










 15%|█████████████▏                                                                          | 449/3000 [33:50<3:12:12,  4.52s/it]










 15%|█████████████▍                                                                          | 459/3000 [34:36<3:11:28,  4.52s/it]










 16%|█████████████▊                                                                          | 469/3000 [35:21<3:10:43,  4.52s/it]










 16%|██████████████                                                                          | 479/3000 [36:06<3:09:58,  4.52s/it]










 16%|██████████████▎                                                                         | 489/3000 [36:51<3:09:12,  4.52s/it]










 17%|██████████████▋                                                                         | 499/3000 [37:36<3:08:28,  4.52s/it]










 17%|██████████████▉                                                                         | 509/3000 [38:22<3:07:41,  4.52s/it]










 17%|███████████████▏                                                                        | 519/3000 [39:07<3:06:57,  4.52s/it]










 18%|███████████████▌                                                                        | 529/3000 [39:52<3:06:12,  4.52s/it]










 18%|███████████████▊                                                                        | 539/3000 [40:37<3:05:25,  4.52s/it]










 18%|████████████████                                                                        | 549/3000 [41:22<3:04:42,  4.52s/it]










 19%|████████████████▍                                                                       | 559/3000 [42:08<3:03:56,  4.52s/it]










 19%|████████████████▋                                                                       | 569/3000 [42:53<3:03:11,  4.52s/it]










 19%|████████████████▉                                                                       | 579/3000 [43:38<3:02:24,  4.52s/it]










 20%|█████████████████▎                                                                      | 589/3000 [44:23<3:01:39,  4.52s/it]










 20%|█████████████████▌                                                                      | 599/3000 [45:09<3:00:54,  4.52s/it]










 20%|█████████████████▊                                                                      | 609/3000 [45:54<3:00:11,  4.52s/it]










 21%|██████████████████▏                                                                     | 619/3000 [46:39<2:59:26,  4.52s/it]










 21%|██████████████████▍                                                                     | 629/3000 [47:24<2:58:39,  4.52s/it]










 21%|██████████████████▋                                                                     | 639/3000 [48:09<2:57:56,  4.52s/it]










 22%|███████████████████                                                                     | 649/3000 [48:55<2:57:09,  4.52s/it]










 22%|███████████████████▎                                                                    | 659/3000 [49:40<2:56:24,  4.52s/it]










 22%|███████████████████▌                                                                    | 669/3000 [50:25<2:55:40,  4.52s/it]










 23%|███████████████████▉                                                                    | 679/3000 [51:10<2:54:54,  4.52s/it]










 23%|████████████████████▏                                                                   | 689/3000 [51:55<2:54:08,  4.52s/it]










 23%|████████████████████▌                                                                   | 699/3000 [52:41<2:53:24,  4.52s/it]










 24%|████████████████████▊                                                                   | 709/3000 [53:26<2:52:37,  4.52s/it]










 24%|█████████████████████                                                                   | 719/3000 [54:11<2:51:54,  4.52s/it]










 24%|█████████████████████▍                                                                  | 729/3000 [54:56<2:51:06,  4.52s/it]










 25%|█████████████████████▋                                                                  | 739/3000 [55:42<2:50:21,  4.52s/it]










 25%|█████████████████████▉                                                                  | 749/3000 [56:27<2:49:36,  4.52s/it]










 25%|██████████████████████▎                                                                 | 759/3000 [57:12<2:48:52,  4.52s/it]










 26%|██████████████████████▌                                                                 | 769/3000 [57:57<2:48:07,  4.52s/it]










 26%|██████████████████████▊                                                                 | 779/3000 [58:42<2:47:21,  4.52s/it]










 26%|███████████████████████▏                                                                | 789/3000 [59:28<2:46:37,  4.52s/it]










 27%|██████████████████████▉                                                               | 799/3000 [1:00:13<2:45:52,  4.52s/it]










 27%|███████████████████████▏                                                              | 809/3000 [1:00:58<2:45:06,  4.52s/it]










 27%|███████████████████████▍                                                              | 819/3000 [1:01:43<2:44:21,  4.52s/it]











 28%|███████████████████████▊                                                              | 830/3000 [1:02:33<2:43:31,  4.52s/it]









 28%|████████████████████████                                                              | 839/3000 [1:03:14<2:42:51,  4.52s/it]










 28%|████████████████████████▎                                                             | 849/3000 [1:03:59<2:42:05,  4.52s/it]










 29%|████████████████████████▌                                                             | 859/3000 [1:04:44<2:41:19,  4.52s/it]










 29%|████████████████████████▉                                                             | 869/3000 [1:05:29<2:40:34,  4.52s/it]











 29%|█████████████████████████▏                                                            | 880/3000 [1:06:19<2:39:46,  4.52s/it]









 30%|█████████████████████████▍                                                            | 889/3000 [1:07:00<2:39:05,  4.52s/it]










 30%|█████████████████████████▊                                                            | 899/3000 [1:07:45<2:38:19,  4.52s/it]










 30%|██████████████████████████                                                            | 909/3000 [1:08:30<2:37:33,  4.52s/it]










 31%|██████████████████████████▎                                                           | 919/3000 [1:09:15<2:36:48,  4.52s/it]










 31%|██████████████████████████▋                                                           | 929/3000 [1:10:01<2:36:03,  4.52s/it]










 31%|██████████████████████████▉                                                           | 939/3000 [1:10:46<2:35:19,  4.52s/it]











 32%|███████████████████████████▏                                                          | 950/3000 [1:11:36<2:34:29,  4.52s/it]









 32%|███████████████████████████▍                                                          | 959/3000 [1:12:16<2:33:51,  4.52s/it]










 32%|███████████████████████████▊                                                          | 969/3000 [1:13:01<2:33:04,  4.52s/it]










 33%|████████████████████████████                                                          | 979/3000 [1:13:47<2:32:17,  4.52s/it]










 33%|████████████████████████████▎                                                         | 989/3000 [1:14:32<2:31:33,  4.52s/it]










 33%|████████████████████████████▎                                                        | 1000/3000 [1:15:22<2:30:43,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-22 18:03:49,754 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 18:03:49,754 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 18:03:49,761 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 18:03:49,761 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 18:03:49,761 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
{'loss': 2.6366, 'learning_rate': 0.0006666666666666666, 'epoch': 2.79}
Saving PrefixEncoder








 34%|████████████████████████████▌                                                        | 1009/3000 [1:16:02<2:30:02,  4.52s/it]










 34%|████████████████████████████▊                                                        | 1019/3000 [1:16:48<2:29:17,  4.52s/it]










 34%|█████████████████████████████▏                                                       | 1029/3000 [1:17:33<2:28:31,  4.52s/it]










 35%|█████████████████████████████▍                                                       | 1039/3000 [1:18:18<2:27:45,  4.52s/it]










 35%|█████████████████████████████▋                                                       | 1049/3000 [1:19:03<2:27:01,  4.52s/it]










 35%|██████████████████████████████                                                       | 1059/3000 [1:19:48<2:26:15,  4.52s/it]










 36%|██████████████████████████████▎                                                      | 1069/3000 [1:20:34<2:25:32,  4.52s/it]










 36%|██████████████████████████████▌                                                      | 1079/3000 [1:21:19<2:24:45,  4.52s/it]










 36%|██████████████████████████████▊                                                      | 1089/3000 [1:22:04<2:24:01,  4.52s/it]










 37%|███████████████████████████████▏                                                     | 1099/3000 [1:22:49<2:23:15,  4.52s/it]










 37%|███████████████████████████████▍                                                     | 1109/3000 [1:23:35<2:22:30,  4.52s/it]










 37%|███████████████████████████████▋                                                     | 1119/3000 [1:24:20<2:21:44,  4.52s/it]










 38%|███████████████████████████████▉                                                     | 1129/3000 [1:25:05<2:20:59,  4.52s/it]










 38%|████████████████████████████████▎                                                    | 1139/3000 [1:25:50<2:20:14,  4.52s/it]










 38%|████████████████████████████████▌                                                    | 1149/3000 [1:26:35<2:19:28,  4.52s/it]










 39%|████████████████████████████████▊                                                    | 1159/3000 [1:27:21<2:18:44,  4.52s/it]










 39%|█████████████████████████████████                                                    | 1169/3000 [1:28:06<2:17:59,  4.52s/it]










 39%|█████████████████████████████████▍                                                   | 1179/3000 [1:28:51<2:17:14,  4.52s/it]










 40%|█████████████████████████████████▋                                                   | 1189/3000 [1:29:36<2:16:28,  4.52s/it]










 40%|█████████████████████████████████▉                                                   | 1199/3000 [1:30:21<2:15:44,  4.52s/it]










 40%|██████████████████████████████████▎                                                  | 1209/3000 [1:31:07<2:14:58,  4.52s/it]










 41%|██████████████████████████████████▌                                                  | 1219/3000 [1:31:52<2:14:13,  4.52s/it]










 41%|██████████████████████████████████▊                                                  | 1229/3000 [1:32:37<2:13:28,  4.52s/it]










 41%|███████████████████████████████████                                                  | 1239/3000 [1:33:22<2:12:42,  4.52s/it]










 42%|███████████████████████████████████▍                                                 | 1249/3000 [1:34:08<2:11:58,  4.52s/it]










 42%|███████████████████████████████████▋                                                 | 1259/3000 [1:34:53<2:11:11,  4.52s/it]










 42%|███████████████████████████████████▉                                                 | 1269/3000 [1:35:38<2:10:26,  4.52s/it]










 43%|████████████████████████████████████▏                                                | 1279/3000 [1:36:23<2:09:41,  4.52s/it]










 43%|████████████████████████████████████▌                                                | 1289/3000 [1:37:08<2:08:56,  4.52s/it]










 43%|████████████████████████████████████▊                                                | 1299/3000 [1:37:54<2:08:11,  4.52s/it]










 44%|█████████████████████████████████████                                                | 1309/3000 [1:38:39<2:07:25,  4.52s/it]










 44%|█████████████████████████████████████▎                                               | 1319/3000 [1:39:24<2:06:40,  4.52s/it]










 44%|█████████████████████████████████████▋                                               | 1329/3000 [1:40:09<2:05:56,  4.52s/it]










 45%|█████████████████████████████████████▉                                               | 1339/3000 [1:40:55<2:05:10,  4.52s/it]










 45%|██████████████████████████████████████▏                                              | 1349/3000 [1:41:40<2:04:25,  4.52s/it]










 45%|██████████████████████████████████████▌                                              | 1359/3000 [1:42:25<2:03:40,  4.52s/it]










 46%|██████████████████████████████████████▊                                              | 1369/3000 [1:43:10<2:02:54,  4.52s/it]










 46%|███████████████████████████████████████                                              | 1379/3000 [1:43:55<2:02:09,  4.52s/it]










 46%|███████████████████████████████████████▎                                             | 1389/3000 [1:44:41<2:01:24,  4.52s/it]










 47%|███████████████████████████████████████▋                                             | 1399/3000 [1:45:26<2:00:38,  4.52s/it]










 47%|███████████████████████████████████████▉                                             | 1409/3000 [1:46:11<1:59:53,  4.52s/it]










 47%|████████████████████████████████████████▏                                            | 1419/3000 [1:46:56<1:59:07,  4.52s/it]










 48%|████████████████████████████████████████▍                                            | 1429/3000 [1:47:41<1:58:22,  4.52s/it]










 48%|████████████████████████████████████████▊                                            | 1439/3000 [1:48:27<1:57:37,  4.52s/it]










 48%|█████████████████████████████████████████                                            | 1449/3000 [1:49:12<1:56:52,  4.52s/it]










 49%|█████████████████████████████████████████▎                                           | 1459/3000 [1:49:57<1:56:06,  4.52s/it]










 49%|█████████████████████████████████████████▌                                           | 1469/3000 [1:50:42<1:55:21,  4.52s/it]










 49%|█████████████████████████████████████████▉                                           | 1479/3000 [1:51:27<1:54:36,  4.52s/it]










 50%|██████████████████████████████████████████▏                                          | 1489/3000 [1:52:13<1:53:50,  4.52s/it]










 50%|██████████████████████████████████████████▍                                          | 1499/3000 [1:52:58<1:53:06,  4.52s/it]










 50%|██████████████████████████████████████████▊                                          | 1509/3000 [1:53:43<1:52:21,  4.52s/it]










 51%|███████████████████████████████████████████                                          | 1519/3000 [1:54:28<1:51:35,  4.52s/it]










 51%|███████████████████████████████████████████▎                                         | 1529/3000 [1:55:14<1:50:50,  4.52s/it]










 51%|███████████████████████████████████████████▌                                         | 1539/3000 [1:55:59<1:50:05,  4.52s/it]










 52%|███████████████████████████████████████████▉                                         | 1549/3000 [1:56:44<1:49:20,  4.52s/it]











 52%|████████████████████████████████████████████▏                                        | 1560/3000 [1:57:34<1:48:30,  4.52s/it]









 52%|████████████████████████████████████████████▍                                        | 1569/3000 [1:58:14<1:47:48,  4.52s/it]











 53%|████████████████████████████████████████████▊                                        | 1580/3000 [1:59:04<1:46:59,  4.52s/it]









 53%|█████████████████████████████████████████████                                        | 1589/3000 [1:59:45<1:46:18,  4.52s/it]










 53%|█████████████████████████████████████████████▎                                       | 1599/3000 [2:00:30<1:45:33,  4.52s/it]










 54%|█████████████████████████████████████████████▌                                       | 1609/3000 [2:01:15<1:44:49,  4.52s/it]










 54%|█████████████████████████████████████████████▊                                       | 1619/3000 [2:02:00<1:44:03,  4.52s/it]











 54%|██████████████████████████████████████████████▏                                      | 1630/3000 [2:02:50<1:43:13,  4.52s/it]









 55%|██████████████████████████████████████████████▍                                      | 1639/3000 [2:03:31<1:42:32,  4.52s/it]









 55%|██████████████████████████████████████████████▋                                      | 1649/3000 [2:04:16<1:41:47,  4.52s/it]










 55%|███████████████████████████████████████████████                                      | 1659/3000 [2:05:01<1:41:02,  4.52s/it]










 56%|███████████████████████████████████████████████▎                                     | 1669/3000 [2:05:46<1:40:16,  4.52s/it]











 56%|███████████████████████████████████████████████▌                                     | 1680/3000 [2:06:36<1:39:27,  4.52s/it]









 56%|███████████████████████████████████████████████▊                                     | 1689/3000 [2:07:17<1:38:46,  4.52s/it]











 57%|████████████████████████████████████████████████▏                                    | 1700/3000 [2:08:07<1:37:56,  4.52s/it]









 57%|████████████████████████████████████████████████▍                                    | 1709/3000 [2:08:47<1:37:16,  4.52s/it]










 57%|████████████████████████████████████████████████▋                                    | 1719/3000 [2:09:33<1:36:30,  4.52s/it]










 58%|████████████████████████████████████████████████▉                                    | 1729/3000 [2:10:18<1:35:45,  4.52s/it]










 58%|█████████████████████████████████████████████████▎                                   | 1739/3000 [2:11:03<1:35:00,  4.52s/it]











 58%|█████████████████████████████████████████████████▌                                   | 1750/3000 [2:11:53<1:34:10,  4.52s/it]









 59%|█████████████████████████████████████████████████▊                                   | 1759/3000 [2:12:33<1:33:30,  4.52s/it]











 59%|██████████████████████████████████████████████████▏                                  | 1770/3000 [2:13:23<1:32:40,  4.52s/it]









 59%|██████████████████████████████████████████████████▍                                  | 1779/3000 [2:14:04<1:32:00,  4.52s/it]










 60%|██████████████████████████████████████████████████▋                                  | 1789/3000 [2:14:49<1:31:14,  4.52s/it]










 60%|██████████████████████████████████████████████████▉                                  | 1799/3000 [2:15:34<1:30:29,  4.52s/it]










 60%|███████████████████████████████████████████████████▎                                 | 1809/3000 [2:16:19<1:29:44,  4.52s/it]











 61%|███████████████████████████████████████████████████▌                                 | 1820/3000 [2:17:09<1:28:54,  4.52s/it]









 61%|███████████████████████████████████████████████████▊                                 | 1829/3000 [2:17:50<1:28:13,  4.52s/it]










 61%|████████████████████████████████████████████████████                                 | 1839/3000 [2:18:35<1:27:29,  4.52s/it]










 62%|████████████████████████████████████████████████████▍                                | 1849/3000 [2:19:20<1:26:43,  4.52s/it]










 62%|████████████████████████████████████████████████████▋                                | 1859/3000 [2:20:05<1:25:58,  4.52s/it]











 62%|████████████████████████████████████████████████████▉                                | 1870/3000 [2:20:55<1:25:09,  4.52s/it]









 63%|█████████████████████████████████████████████████████▏                               | 1879/3000 [2:21:36<1:24:27,  4.52s/it]











 63%|█████████████████████████████████████████████████████▌                               | 1890/3000 [2:22:26<1:23:38,  4.52s/it]









 63%|█████████████████████████████████████████████████████▊                               | 1899/3000 [2:23:06<1:22:57,  4.52s/it]










 64%|██████████████████████████████████████████████████████                               | 1909/3000 [2:23:52<1:22:12,  4.52s/it]










 64%|██████████████████████████████████████████████████████▎                              | 1919/3000 [2:24:37<1:21:27,  4.52s/it]










 64%|██████████████████████████████████████████████████████▋                              | 1929/3000 [2:25:22<1:20:42,  4.52s/it]











 65%|██████████████████████████████████████████████████████▉                              | 1940/3000 [2:26:12<1:19:52,  4.52s/it]









 65%|███████████████████████████████████████████████████████▏                             | 1949/3000 [2:26:52<1:19:11,  4.52s/it]










 65%|███████████████████████████████████████████████████████▌                             | 1959/3000 [2:27:38<1:18:26,  4.52s/it]










 66%|███████████████████████████████████████████████████████▊                             | 1969/3000 [2:28:23<1:17:41,  4.52s/it]










 66%|████████████████████████████████████████████████████████                             | 1979/3000 [2:29:08<1:16:56,  4.52s/it]











 66%|████████████████████████████████████████████████████████▍                            | 1990/3000 [2:29:58<1:16:06,  4.52s/it]









 67%|████████████████████████████████████████████████████████▋                            | 1999/3000 [2:30:38<1:15:26,  4.52s/it]
{'loss': 2.7756, 'learning_rate': 0.0003333333333333333, 'epoch': 5.59}
 67%|████████████████████████████████████████████████████████▋                            | 2000/3000 [2:30:43<1:15:21,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-22 19:19:11,082 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 19:19:11,082 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 19:19:11,088 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 19:19:11,089 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 19:19:11,089 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(









 67%|████████████████████████████████████████████████████████▉                            | 2010/3000 [2:31:28<1:14:36,  4.52s/it]









 67%|█████████████████████████████████████████████████████████▏                           | 2019/3000 [2:32:09<1:13:55,  4.52s/it]










 68%|█████████████████████████████████████████████████████████▍                           | 2029/3000 [2:32:54<1:13:10,  4.52s/it]











 68%|█████████████████████████████████████████████████████████▊                           | 2040/3000 [2:33:44<1:12:20,  4.52s/it]









 68%|██████████████████████████████████████████████████████████                           | 2049/3000 [2:34:25<1:11:39,  4.52s/it]











 69%|██████████████████████████████████████████████████████████▎                          | 2060/3000 [2:35:14<1:10:49,  4.52s/it]









 69%|██████████████████████████████████████████████████████████▌                          | 2069/3000 [2:35:55<1:10:08,  4.52s/it]










 69%|██████████████████████████████████████████████████████████▉                          | 2079/3000 [2:36:40<1:09:24,  4.52s/it]










 70%|███████████████████████████████████████████████████████████▏                         | 2089/3000 [2:37:25<1:08:38,  4.52s/it]










 70%|███████████████████████████████████████████████████████████▍                         | 2099/3000 [2:38:11<1:07:53,  4.52s/it]











 70%|███████████████████████████████████████████████████████████▊                         | 2110/3000 [2:39:00<1:07:03,  4.52s/it]









 71%|████████████████████████████████████████████████████████████                         | 2119/3000 [2:39:41<1:06:23,  4.52s/it]











 71%|████████████████████████████████████████████████████████████▎                        | 2130/3000 [2:40:31<1:05:33,  4.52s/it]









 71%|████████████████████████████████████████████████████████████▌                        | 2139/3000 [2:41:11<1:04:52,  4.52s/it]










 72%|████████████████████████████████████████████████████████████▉                        | 2149/3000 [2:41:57<1:04:07,  4.52s/it]











 72%|█████████████████████████████████████████████████████████████▏                       | 2160/3000 [2:42:46<1:03:17,  4.52s/it]









 72%|█████████████████████████████████████████████████████████████▍                       | 2169/3000 [2:43:27<1:02:36,  4.52s/it]










 73%|█████████████████████████████████████████████████████████████▋                       | 2179/3000 [2:44:12<1:01:52,  4.52s/it]










 73%|██████████████████████████████████████████████████████████████                       | 2189/3000 [2:44:57<1:01:06,  4.52s/it]










 73%|██████████████████████████████████████████████████████████████▎                      | 2199/3000 [2:45:43<1:00:21,  4.52s/it]










 74%|████████████████████████████████████████████████████████████████                       | 2209/3000 [2:46:28<59:36,  4.52s/it]










 74%|████████████████████████████████████████████████████████████████▎                      | 2219/3000 [2:47:13<58:50,  4.52s/it]











 74%|████████████████████████████████████████████████████████████████▋                      | 2230/3000 [2:48:03<58:00,  4.52s/it]









 75%|████████████████████████████████████████████████████████████████▉                      | 2239/3000 [2:48:44<57:20,  4.52s/it]










 75%|█████████████████████████████████████████████████████████████████▏                     | 2249/3000 [2:49:29<56:35,  4.52s/it]










 75%|█████████████████████████████████████████████████████████████████▌                     | 2259/3000 [2:50:14<55:50,  4.52s/it]










 76%|█████████████████████████████████████████████████████████████████▊                     | 2269/3000 [2:50:59<55:04,  4.52s/it]











 76%|██████████████████████████████████████████████████████████████████                     | 2280/3000 [2:51:49<54:15,  4.52s/it]









 76%|██████████████████████████████████████████████████████████████████▍                    | 2289/3000 [2:52:30<53:34,  4.52s/it]










 77%|██████████████████████████████████████████████████████████████████▋                    | 2299/3000 [2:53:15<52:49,  4.52s/it]










 77%|██████████████████████████████████████████████████████████████████▉                    | 2309/3000 [2:54:00<52:04,  4.52s/it]










 77%|███████████████████████████████████████████████████████████████████▎                   | 2319/3000 [2:54:45<51:19,  4.52s/it]










 78%|███████████████████████████████████████████████████████████████████▌                   | 2329/3000 [2:55:30<50:33,  4.52s/it]










 78%|███████████████████████████████████████████████████████████████████▊                   | 2339/3000 [2:56:16<49:48,  4.52s/it]











 78%|████████████████████████████████████████████████████████████████████▏                  | 2350/3000 [2:57:05<48:58,  4.52s/it]









 79%|████████████████████████████████████████████████████████████████████▍                  | 2359/3000 [2:57:46<48:18,  4.52s/it]










 79%|████████████████████████████████████████████████████████████████████▋                  | 2369/3000 [2:58:31<47:32,  4.52s/it]










 79%|████████████████████████████████████████████████████████████████████▉                  | 2379/3000 [2:59:17<46:48,  4.52s/it]










 80%|█████████████████████████████████████████████████████████████████████▎                 | 2389/3000 [3:00:02<46:04,  4.52s/it]











 80%|█████████████████████████████████████████████████████████████████████▌                 | 2400/3000 [3:00:52<45:14,  4.52s/it]









 80%|█████████████████████████████████████████████████████████████████████▊                 | 2409/3000 [3:01:32<44:33,  4.52s/it]










 81%|██████████████████████████████████████████████████████████████████████▏                | 2419/3000 [3:02:18<43:48,  4.52s/it]










 81%|██████████████████████████████████████████████████████████████████████▍                | 2429/3000 [3:03:03<43:02,  4.52s/it]










 81%|██████████████████████████████████████████████████████████████████████▋                | 2439/3000 [3:03:48<42:17,  4.52s/it]











 82%|███████████████████████████████████████████████████████████████████████                | 2450/3000 [3:04:38<41:28,  4.52s/it]









 82%|███████████████████████████████████████████████████████████████████████▎               | 2459/3000 [3:05:18<40:47,  4.52s/it]










 82%|███████████████████████████████████████████████████████████████████████▌               | 2469/3000 [3:06:04<40:02,  4.52s/it]










 83%|███████████████████████████████████████████████████████████████████████▉               | 2479/3000 [3:06:49<39:17,  4.52s/it]










 83%|████████████████████████████████████████████████████████████████████████▏              | 2489/3000 [3:07:34<38:31,  4.52s/it]











 83%|████████████████████████████████████████████████████████████████████████▌              | 2500/3000 [3:08:24<37:42,  4.52s/it]









 84%|████████████████████████████████████████████████████████████████████████▊              | 2509/3000 [3:09:05<37:01,  4.52s/it]










 84%|█████████████████████████████████████████████████████████████████████████              | 2519/3000 [3:09:50<36:16,  4.52s/it]










 84%|█████████████████████████████████████████████████████████████████████████▎             | 2529/3000 [3:10:35<35:31,  4.52s/it]










 85%|█████████████████████████████████████████████████████████████████████████▋             | 2539/3000 [3:11:20<34:45,  4.52s/it]











 85%|█████████████████████████████████████████████████████████████████████████▉             | 2550/3000 [3:12:10<33:56,  4.52s/it]









 85%|██████████████████████████████████████████████████████████████████████████▏            | 2559/3000 [3:12:51<33:15,  4.52s/it]










 86%|██████████████████████████████████████████████████████████████████████████▌            | 2569/3000 [3:13:36<32:29,  4.52s/it]










 86%|██████████████████████████████████████████████████████████████████████████▊            | 2579/3000 [3:14:21<31:44,  4.52s/it]










 86%|███████████████████████████████████████████████████████████████████████████            | 2589/3000 [3:15:07<30:59,  4.52s/it]











 87%|███████████████████████████████████████████████████████████████████████████▍           | 2600/3000 [3:15:56<30:09,  4.52s/it]









 87%|███████████████████████████████████████████████████████████████████████████▋           | 2609/3000 [3:16:37<29:28,  4.52s/it]










 87%|███████████████████████████████████████████████████████████████████████████▉           | 2619/3000 [3:17:22<28:43,  4.52s/it]











 88%|████████████████████████████████████████████████████████████████████████████▎          | 2630/3000 [3:18:12<27:53,  4.52s/it]









 88%|████████████████████████████████████████████████████████████████████████████▌          | 2639/3000 [3:18:53<27:13,  4.52s/it]











 88%|████████████████████████████████████████████████████████████████████████████▊          | 2650/3000 [3:19:43<26:23,  4.52s/it]









 89%|█████████████████████████████████████████████████████████████████████████████          | 2659/3000 [3:20:23<25:42,  4.52s/it]










 89%|█████████████████████████████████████████████████████████████████████████████▍         | 2669/3000 [3:21:09<24:57,  4.52s/it]











 89%|█████████████████████████████████████████████████████████████████████████████▋         | 2680/3000 [3:21:58<24:07,  4.52s/it]









 90%|█████████████████████████████████████████████████████████████████████████████▉         | 2689/3000 [3:22:39<23:26,  4.52s/it]











 90%|██████████████████████████████████████████████████████████████████████████████▎        | 2700/3000 [3:23:29<22:37,  4.52s/it]









 90%|██████████████████████████████████████████████████████████████████████████████▌        | 2709/3000 [3:24:10<21:56,  4.53s/it]










 91%|██████████████████████████████████████████████████████████████████████████████▊        | 2719/3000 [3:24:55<21:11,  4.52s/it]











 91%|███████████████████████████████████████████████████████████████████████████████▏       | 2730/3000 [3:25:45<20:21,  4.52s/it]









 91%|███████████████████████████████████████████████████████████████████████████████▍       | 2739/3000 [3:26:25<19:40,  4.52s/it]











 92%|███████████████████████████████████████████████████████████████████████████████▊       | 2750/3000 [3:27:15<18:50,  4.52s/it]









 92%|████████████████████████████████████████████████████████████████████████████████       | 2759/3000 [3:27:56<18:10,  4.52s/it]











 92%|████████████████████████████████████████████████████████████████████████████████▎      | 2770/3000 [3:28:46<17:20,  4.52s/it]










 93%|████████████████████████████████████████████████████████████████████████████████▌      | 2780/3000 [3:29:31<16:35,  4.52s/it]









 93%|████████████████████████████████████████████████████████████████████████████████▉      | 2789/3000 [3:30:11<15:54,  4.52s/it]











 93%|█████████████████████████████████████████████████████████████████████████████████▏     | 2800/3000 [3:31:01<15:04,  4.52s/it]









 94%|█████████████████████████████████████████████████████████████████████████████████▍     | 2809/3000 [3:31:42<14:24,  4.52s/it]










 94%|█████████████████████████████████████████████████████████████████████████████████▊     | 2819/3000 [3:32:27<13:38,  4.52s/it]











 94%|██████████████████████████████████████████████████████████████████████████████████     | 2830/3000 [3:33:17<12:49,  4.52s/it]









 95%|██████████████████████████████████████████████████████████████████████████████████▎    | 2839/3000 [3:33:58<12:08,  4.52s/it]











 95%|██████████████████████████████████████████████████████████████████████████████████▋    | 2850/3000 [3:34:47<11:18,  4.52s/it]









 95%|██████████████████████████████████████████████████████████████████████████████████▉    | 2859/3000 [3:35:28<10:37,  4.52s/it]










 96%|███████████████████████████████████████████████████████████████████████████████████▏   | 2869/3000 [3:36:13<09:52,  4.52s/it]











 96%|███████████████████████████████████████████████████████████████████████████████████▌   | 2880/3000 [3:37:03<09:02,  4.52s/it]









 96%|███████████████████████████████████████████████████████████████████████████████████▊   | 2889/3000 [3:37:44<08:22,  4.52s/it]











 97%|████████████████████████████████████████████████████████████████████████████████████   | 2900/3000 [3:38:34<07:32,  4.52s/it]









 97%|████████████████████████████████████████████████████████████████████████████████████▎  | 2909/3000 [3:39:14<06:51,  4.52s/it]











 97%|████████████████████████████████████████████████████████████████████████████████████▋  | 2920/3000 [3:40:04<06:01,  4.52s/it]










 98%|████████████████████████████████████████████████████████████████████████████████████▉  | 2930/3000 [3:40:49<05:16,  4.52s/it]









 98%|█████████████████████████████████████████████████████████████████████████████████████▏ | 2939/3000 [3:41:30<04:35,  4.52s/it]











 98%|█████████████████████████████████████████████████████████████████████████████████████▌ | 2950/3000 [3:42:20<03:46,  4.52s/it]









 99%|█████████████████████████████████████████████████████████████████████████████████████▊ | 2959/3000 [3:43:01<03:05,  4.52s/it]











 99%|██████████████████████████████████████████████████████████████████████████████████████▏| 2970/3000 [3:43:50<02:15,  4.52s/it]










 99%|██████████████████████████████████████████████████████████████████████████████████████▍| 2980/3000 [3:44:36<01:30,  4.52s/it]









100%|██████████████████████████████████████████████████████████████████████████████████████▋| 2989/3000 [3:45:16<00:49,  4.52s/it]










100%|███████████████████████████████████████████████████████████████████████████████████████| 3000/3000 [3:46:06<00:00,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-22 20:34:34,231 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-3000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 20:34:34,232 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-3000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 20:34:34,238 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-3000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 20:34:34,238 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-3000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 20:34:34,238 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-3000/special_tokens_map.json
[INFO|trainer.py:2053] 2024-01-22 20:34:34,253 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|███████████████████████████████████████████████████████████████████████████████████████| 3000/3000 [3:46:06<00:00,  4.52s/it]
{'loss': 2.8063, 'learning_rate': 0.0, 'epoch': 8.38}
Saving PrefixEncoder
{'train_runtime': 13566.6725, 'train_samples_per_second': 3.538, 'train_steps_per_second': 0.221, 'train_loss': 2.7221293029785154, 'epoch': 8.38}
train_result <class 'transformers.trainer_utils.TrainOutput'>
TrainOutput(global_step=3000, training_loss=2.7221293029785154, metrics={'train_runtime': 13566.6725, 'train_samples_per_second': 3.538, 'train_steps_per_second': 0.221, 'train_loss': 2.7221293029785154, 'epoch': 8.38})
metric type <class 'dict'>
{'train_runtime': 13566.6725, 'train_samples_per_second': 3.538, 'train_steps_per_second': 0.221, 'train_loss': 2.7221293029785154, 'epoch': 8.38}
***** train metrics *****
  epoch                    =       8.38
  train_loss               =     2.7221
  train_runtime            = 3:46:06.67
  train_samples            =       5725
  train_samples_per_second =      3.538
  train_steps_per_second   =      0.221