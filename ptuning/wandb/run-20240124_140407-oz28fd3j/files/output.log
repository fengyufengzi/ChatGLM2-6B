/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/datasets/load.py:2483: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
[INFO|configuration_utils.py:667] 2024-01-24 14:04:16,088 >> loading configuration file /home/ubuntu/Documents/ai/model/chatglm2-6b/config.json
[INFO|configuration_utils.py:667] 2024-01-24 14:04:16,089 >> loading configuration file /home/ubuntu/Documents/ai/model/chatglm2-6b/config.json
[INFO|configuration_utils.py:725] 2024-01-24 14:04:16,089 >> Model config ChatGLMConfig {
  "_name_or_path": "/home/ubuntu/Documents/ai/model/chatglm2-6b",
  "add_bias_linear": false,
  "add_qkv_bias": true,
  "apply_query_key_layer_scaling": true,
  "apply_residual_connection_post_layernorm": false,
  "architectures": [
    "ChatGLMModel"
  ],
  "attention_dropout": 0.0,
  "attention_softmax_in_fp32": true,
  "auto_map": {
    "AutoConfig": "configuration_chatglm.ChatGLMConfig",
    "AutoModel": "modeling_chatglm.ChatGLMForConditionalGeneration",
    "AutoModelForCausalLM": "modeling_chatglm.ChatGLMForConditionalGeneration",
    "AutoModelForSeq2SeqLM": "modeling_chatglm.ChatGLMForConditionalGeneration",
    "AutoModelForSequenceClassification": "modeling_chatglm.ChatGLMForSequenceClassification"
  },
  "bias_dropout_fusion": true,
  "classifier_dropout": null,
  "eos_token_id": 2,
  "ffn_hidden_size": 13696,
  "fp32_residual_connection": false,
  "hidden_dropout": 0.0,
  "hidden_size": 4096,
  "kv_channels": 128,
  "layernorm_epsilon": 1e-05,
  "model_type": "chatglm",
  "multi_query_attention": true,
  "multi_query_group_num": 2,
  "num_attention_heads": 32,
  "num_layers": 28,
  "original_rope": true,
  "pad_token_id": 0,
  "padded_vocab_size": 65024,
  "post_layer_norm": true,
  "pre_seq_len": null,
  "prefix_projection": false,
  "quantization_bit": 0,
  "rmsnorm": true,
  "seq_length": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "float16",
  "transformers_version": "4.30.2",
  "use_cache": true,
  "vocab_size": 65024
}
[INFO|tokenization_utils_base.py:1821] 2024-01-24 14:04:16,090 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:1821] 2024-01-24 14:04:16,090 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:1821] 2024-01-24 14:04:16,090 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:1821] 2024-01-24 14:04:16,090 >> loading file tokenizer_config.json
[INFO|modeling_utils.py:2575] 2024-01-24 14:04:16,133 >> loading weights file /home/ubuntu/Documents/ai/model/chatglm2-6b/pytorch_model.bin.index.json
[INFO|configuration_utils.py:577] 2024-01-24 14:04:16,133 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
Loading checkpoint shards:  14%|█████████▋                                                          | 1/7 [00:00<00:04,  1.40it/s]

Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.45it/s]
[INFO|modeling_utils.py:3295] 2024-01-24 14:04:20,998 >> All model checkpoint weights were used when initializing ChatGLMForConditionalGeneration.
[WARNING|modeling_utils.py:3297] 2024-01-24 14:04:20,998 >> Some weights of ChatGLMForConditionalGeneration were not initialized from the model checkpoint at /home/ubuntu/Documents/ai/model/chatglm2-6b and are newly initialized: ['transformer.prefix_encoder.embedding.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[INFO|modeling_utils.py:2927] 2024-01-24 14:04:20,999 >> Generation config file not found, using a generation config created from the model config.
Quantized to 8 bit
Running tokenizer on train dataset:  17%|███████▋                                    | 1000/5726 [00:00<00:02, 1673.78 examples/s]
prefix: [支付宝专用]
    请用最简洁的语言回答‘###’后面的问题,回答中不要重复问题内容，如果你不清楚这个问题的答案，就说'对不起，根据参考资料无法回答.'

Running tokenizer on train dataset:  87%|██████████████████████████████████████▍     | 5000/5726 [00:03<00:00, 1647.61 examples/s]
input_ids [64790, 64792, 790, 39063, 36333, 30996, 13, 296, 55073, 54437, 40697, 40042, 33287, 31028, 1754, 31010, 30963, 35005, 32184, 30932, 33287, 54538, 31844, 35287, 31639, 31795, 31123, 32763, 43082, 31646, 32890, 33161, 31123, 43449, 30953, 43279, 31123, 31793, 33214, 32315, 32067, 33287, 4255, 13, 296, 1754, 31010, 30995, 30951, 517, 30910, 30939, 30996, 13, 13, 54761, 31211, 36384, 35074, 55435, 54919, 37686, 30987, 13, 30910, 49685, 54638, 30954, 54855, 54539, 35679, 30946, 49685, 54638, 54855, 54973, 54714, 30939, 30970, 54943, 33599, 56005, 54747, 35679, 30946, 49685, 54638, 56005, 55901, 54714, 30943, 30939, 54943, 33217, 54750, 41189, 30954, 58812, 55555, 35679, 30946, 54750, 41189, 55148, 55555, 33136, 30939, 30939, 55067, 33599, 55344, 54615, 35679, 30946, 54750, 41189, 54809, 56214, 54704, 54641, 30939, 30943, 54943, 33217, 56446, 34582, 30954, 54547, 56365, 35679, 30946, 56446, 34582, 57591, 55086, 54662, 30973, 54943, 33599, 54645, 56890, 55284, 35679, 30946, 56446, 34582, 55066, 55771, 33856, 30966, 30978, 30973, 56519, 30939, 30943, 54943, 33217, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
inputs [支付宝专用]
    请用最简洁的语言回答‘###’后面的问题,回答中不要重复问题内容，如果你不清楚这个问题的答案，就说'对不起，根据参考资料无法回答.'
    ###[Round 1]
问：福州身份证换证在哪里?
 鼓楼区:华大派出所(鼓楼区华林路15号)、洪山派出所(鼓楼区洪甘路21号)。台江区:鳌峰派出所(台江区亚峰小区11座)、宁化派出所(台江区万寿二道12号)。仓山区:上渡派出所(仓山区堤边里8号)、三叉街派出所(仓山区则徐大道368弄12号)。
label_ids [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 30910, 49685, 54638, 30954, 54855, 54539, 35679, 30946, 49685, 54638, 54855, 54973, 54714, 30939, 30970, 54943, 33599, 56005, 54747, 35679, 30946, 49685, 54638, 56005, 55901, 54714, 30943, 30939, 54943, 33217, 54750, 41189, 30954, 58812, 55555, 35679, 30946, 54750, 41189, 55148, 55555, 33136, 30939, 30939, 55067, 33599, 55344, 54615, 35679, 30946, 54750, 41189, 54809, 56214, 54704, 54641, 30939, 30943, 54943, 33217, 56446, 34582, 30954, 54547, 56365, 35679, 30946, 56446, 34582, 57591, 55086, 54662, 30973, 54943, 33599, 54645, 56890, 55284, 35679, 30946, 56446, 34582, 55066, 55771, 33856, 30966, 30978, 30973, 56519, 30939, 30943, 54943, 33217, 2, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100]
labels 鼓楼区:华大派出所(鼓楼区华林路15号)、洪山派出所(鼓楼区洪甘路21号)。台江区:鳌峰派出所(台江区亚峰小区11座)、宁化派出所(台江区万寿二道12号)。仓山区:上渡派出所(仓山区堤边里8号)、三叉街派出所(仓山区则徐大道368弄12号)。
inputs[支付宝专用]
    请用最简洁的语言回答‘###’后面的问题,回答中不要重复问题内容，如果你不清楚这个问题的答案，就说'对不起，根据参考资料无法回答.'
    ###什么是蚂蚁庄园
input_ids [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64790, 64792, 790, 39063, 36333, 30996, 13, 296, 55073, 54437, 40697, 40042, 33287, 31028, 1754, 31010, 30963, 35005, 32184, 30932, 33287, 54538, 31844, 35287, 31639, 31795, 31123, 32763, 43082, 31646, 32890, 33161, 31123, 43449, 30953, 43279, 31123, 31793, 33214, 32315, 32067, 33287, 4255, 13, 296, 1754, 31010, 35318, 41069, 46980]
inputs [支付宝专用]
    请用最简洁的语言回答‘###’后面的问题,回答中不要重复问题内容，如果你不清楚这个问题的答案，就说'对不起，根据参考资料无法回答.'
    ###什么是蚂蚁庄园
label_ids [64790, 64792, 30910, 41069, 46980, 41680, 33053, 39063, 32488, 39330, 38346, 35439, 32033, 31155]
Running tokenizer on train dataset: 100%|████████████████████████████████████████████| 5726/5726 [00:03<00:00, 1655.97 examples/s]
Running tokenizer on validation dataset: 100%|█████████████████████████████████████████| 315/315 [00:00<00:00, 6575.39 examples/s]
[INFO|trainer.py:577] 2024-01-24 14:04:28,526 >> max_steps is given, it will override any value given in num_train_epochs
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[INFO|trainer.py:1786] 2024-01-24 14:04:29,047 >> ***** Running training *****
[INFO|trainer.py:1787] 2024-01-24 14:04:29,047 >>   Num examples = 5,725
[INFO|trainer.py:1788] 2024-01-24 14:04:29,047 >>   Num Epochs = 6
[INFO|trainer.py:1789] 2024-01-24 14:04:29,047 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:1790] 2024-01-24 14:04:29,047 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:1791] 2024-01-24 14:04:29,047 >>   Gradient Accumulation steps = 16
[INFO|trainer.py:1792] 2024-01-24 14:04:29,048 >>   Total optimization steps = 2,100
[INFO|trainer.py:1793] 2024-01-24 14:04:29,048 >>   Number of trainable parameters = 1,835,008
[INFO|integrations.py:727] 2024-01-24 14:04:29,074 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|                                                                                                    | 0/2100 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
01/24/2024 14:04:29 - WARNING - transformers_modules.chatglm2-6b.modeling_chatglm - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...









  0%|▍                                                                                        | 10/2100 [00:45<2:37:45,  4.53s/it]










  1%|▊                                                                                        | 20/2100 [01:31<2:36:42,  4.52s/it]









  1%|█▏                                                                                       | 29/2100 [02:11<2:36:02,  4.52s/it]











  2%|█▋                                                                                       | 40/2100 [03:01<2:35:20,  4.52s/it]










  2%|██                                                                                       | 50/2100 [03:46<2:34:36,  4.53s/it]










  3%|██▌                                                                                      | 60/2100 [04:32<2:33:51,  4.53s/it]










  3%|██▉                                                                                      | 70/2100 [05:17<2:33:05,  4.53s/it]









  4%|███▎                                                                                     | 79/2100 [05:58<2:32:25,  4.53s/it]










  4%|███▊                                                                                     | 89/2100 [06:43<2:31:39,  4.52s/it]










  5%|████▏                                                                                    | 99/2100 [07:28<2:30:55,  4.53s/it]










  5%|████▌                                                                                   | 109/2100 [08:13<2:30:09,  4.53s/it]










  6%|████▉                                                                                   | 119/2100 [08:59<2:29:24,  4.53s/it]










  6%|█████▍                                                                                  | 129/2100 [09:44<2:28:39,  4.53s/it]










  7%|█████▊                                                                                  | 139/2100 [10:29<2:27:52,  4.52s/it]










  7%|██████▏                                                                                 | 149/2100 [11:14<2:27:07,  4.52s/it]











  8%|██████▋                                                                                 | 160/2100 [12:04<2:26:21,  4.53s/it]










  8%|███████                                                                                 | 170/2100 [12:49<2:25:33,  4.53s/it]










  9%|███████▌                                                                                | 180/2100 [13:35<2:24:48,  4.53s/it]










  9%|███████▉                                                                                | 190/2100 [14:20<2:24:02,  4.52s/it]










 10%|████████▍                                                                               | 200/2100 [15:05<2:23:17,  4.53s/it]










 10%|████████▊                                                                               | 210/2100 [15:50<2:22:31,  4.52s/it]










 10%|█████████▏                                                                              | 220/2100 [16:36<2:21:46,  4.52s/it]










 11%|█████████▋                                                                              | 230/2100 [17:21<2:21:02,  4.53s/it]










 11%|██████████                                                                              | 240/2100 [18:06<2:20:18,  4.53s/it]










 12%|██████████▍                                                                             | 250/2100 [18:51<2:19:31,  4.53s/it]










 12%|██████████▉                                                                             | 260/2100 [19:37<2:18:45,  4.52s/it]










 13%|███████████▎                                                                            | 270/2100 [20:22<2:18:01,  4.53s/it]










 13%|███████████▋                                                                            | 280/2100 [21:07<2:17:15,  4.53s/it]










 14%|████████████▏                                                                           | 290/2100 [21:52<2:16:30,  4.53s/it]










 14%|████████████▌                                                                           | 300/2100 [22:38<2:15:46,  4.53s/it]










 15%|████████████▉                                                                           | 310/2100 [23:23<2:15:02,  4.53s/it]










 15%|█████████████▍                                                                          | 320/2100 [24:08<2:14:17,  4.53s/it]










 16%|█████████████▊                                                                          | 330/2100 [24:53<2:13:31,  4.53s/it]










 16%|██████████████▏                                                                         | 340/2100 [25:39<2:12:45,  4.53s/it]










 17%|██████████████▋                                                                         | 350/2100 [26:24<2:12:01,  4.53s/it]










 17%|███████████████                                                                         | 360/2100 [27:09<2:11:14,  4.53s/it]










 18%|███████████████▌                                                                        | 370/2100 [27:54<2:10:28,  4.53s/it]










 18%|███████████████▉                                                                        | 380/2100 [28:40<2:09:45,  4.53s/it]










 19%|████████████████▎                                                                       | 390/2100 [29:25<2:09:04,  4.53s/it]










 19%|████████████████▊                                                                       | 400/2100 [30:10<2:08:16,  4.53s/it]










 20%|█████████████████▏                                                                      | 410/2100 [30:56<2:07:28,  4.53s/it]










 20%|█████████████████▌                                                                      | 420/2100 [31:41<2:06:42,  4.53s/it]










 20%|██████████████████                                                                      | 430/2100 [32:26<2:05:58,  4.53s/it]










 21%|██████████████████▍                                                                     | 440/2100 [33:11<2:05:12,  4.53s/it]










 21%|██████████████████▊                                                                     | 450/2100 [33:57<2:04:26,  4.53s/it]










 22%|███████████████████▎                                                                    | 460/2100 [34:42<2:03:41,  4.53s/it]










 22%|███████████████████▋                                                                    | 470/2100 [35:27<2:02:56,  4.53s/it]










 23%|████████████████████                                                                    | 480/2100 [36:12<2:02:09,  4.52s/it]










 23%|████████████████████▌                                                                   | 490/2100 [36:58<2:01:25,  4.53s/it]










 24%|████████████████████▉                                                                   | 500/2100 [37:43<2:00:39,  4.52s/it]










 24%|█████████████████████▎                                                                  | 510/2100 [38:28<1:59:55,  4.53s/it]










 25%|█████████████████████▊                                                                  | 520/2100 [39:13<1:59:09,  4.53s/it]










 25%|██████████████████████▏                                                                 | 530/2100 [39:59<1:58:24,  4.53s/it]










 26%|██████████████████████▋                                                                 | 540/2100 [40:44<1:57:38,  4.52s/it]










 26%|███████████████████████                                                                 | 550/2100 [41:29<1:56:52,  4.52s/it]










 27%|███████████████████████▍                                                                | 560/2100 [42:14<1:56:08,  4.52s/it]










 27%|███████████████████████▉                                                                | 570/2100 [43:00<1:55:22,  4.52s/it]










 28%|████████████████████████▎                                                               | 580/2100 [43:45<1:54:37,  4.52s/it]










 28%|████████████████████████▋                                                               | 590/2100 [44:30<1:53:52,  4.52s/it]










 29%|█████████████████████████▏                                                              | 600/2100 [45:15<1:53:06,  4.52s/it]










 29%|█████████████████████████▌                                                              | 610/2100 [46:01<1:52:22,  4.52s/it]










 30%|█████████████████████████▉                                                              | 620/2100 [46:46<1:51:36,  4.52s/it]










 30%|██████████████████████████▍                                                             | 630/2100 [47:31<1:50:51,  4.52s/it]










 30%|██████████████████████████▊                                                             | 640/2100 [48:16<1:50:05,  4.52s/it]










 31%|███████████████████████████▏                                                            | 650/2100 [49:02<1:49:20,  4.52s/it]










 31%|███████████████████████████▋                                                            | 660/2100 [49:47<1:48:35,  4.52s/it]










 32%|████████████████████████████                                                            | 670/2100 [50:32<1:47:50,  4.52s/it]










 32%|████████████████████████████▍                                                           | 680/2100 [51:17<1:47:05,  4.52s/it]










 33%|████████████████████████████▉                                                           | 690/2100 [52:03<1:46:19,  4.52s/it]









 33%|█████████████████████████████▎                                                          | 700/2100 [52:48<1:45:34,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-24 14:57:17,374 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-700/config.json
[INFO|configuration_utils.py:364] 2024-01-24 14:57:17,375 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-700/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-24 14:57:17,381 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-700/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-24 14:57:17,381 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-24 14:57:17,381 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-700/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
{'loss': 2.7989, 'learning_rate': 0.003333333333333333, 'epoch': 1.96}
Saving PrefixEncoder









 34%|█████████████████████████████▊                                                          | 710/2100 [53:33<1:44:48,  4.52s/it]










 34%|██████████████████████████████▏                                                         | 720/2100 [54:18<1:44:03,  4.52s/it]










 35%|██████████████████████████████▌                                                         | 730/2100 [55:04<1:43:18,  4.52s/it]










 35%|███████████████████████████████                                                         | 740/2100 [55:49<1:42:33,  4.52s/it]










 36%|███████████████████████████████▍                                                        | 750/2100 [56:34<1:41:48,  4.52s/it]










 36%|███████████████████████████████▊                                                        | 760/2100 [57:19<1:41:02,  4.52s/it]










 37%|████████████████████████████████▎                                                       | 770/2100 [58:05<1:40:18,  4.52s/it]










 37%|████████████████████████████████▋                                                       | 780/2100 [58:50<1:39:33,  4.53s/it]










 38%|█████████████████████████████████                                                       | 790/2100 [59:35<1:38:46,  4.52s/it]










 38%|████████████████████████████████▊                                                     | 800/2100 [1:00:20<1:38:01,  4.52s/it]










 39%|█████████████████████████████████▏                                                    | 810/2100 [1:01:06<1:37:16,  4.52s/it]










 39%|█████████████████████████████████▌                                                    | 820/2100 [1:01:51<1:36:31,  4.52s/it]










 40%|█████████████████████████████████▉                                                    | 830/2100 [1:02:36<1:35:46,  4.52s/it]










 40%|██████████████████████████████████▍                                                   | 840/2100 [1:03:21<1:35:00,  4.52s/it]










 40%|██████████████████████████████████▊                                                   | 850/2100 [1:04:07<1:34:15,  4.52s/it]










 41%|███████████████████████████████████▏                                                  | 860/2100 [1:04:52<1:33:30,  4.52s/it]










 41%|███████████████████████████████████▋                                                  | 870/2100 [1:05:37<1:32:45,  4.52s/it]










 42%|████████████████████████████████████                                                  | 880/2100 [1:06:22<1:32:00,  4.53s/it]










 42%|████████████████████████████████████▍                                                 | 890/2100 [1:07:08<1:31:15,  4.52s/it]










 43%|████████████████████████████████████▊                                                 | 900/2100 [1:07:53<1:30:29,  4.52s/it]










 43%|█████████████████████████████████████▎                                                | 910/2100 [1:08:38<1:29:44,  4.52s/it]










 44%|█████████████████████████████████████▋                                                | 920/2100 [1:09:23<1:28:58,  4.52s/it]










 44%|██████████████████████████████████████                                                | 930/2100 [1:10:09<1:28:13,  4.52s/it]










 45%|██████████████████████████████████████▍                                               | 940/2100 [1:10:54<1:27:29,  4.53s/it]










 45%|██████████████████████████████████████▉                                               | 950/2100 [1:11:39<1:26:47,  4.53s/it]










 46%|███████████████████████████████████████▎                                              | 960/2100 [1:12:24<1:26:00,  4.53s/it]










 46%|███████████████████████████████████████▋                                              | 970/2100 [1:13:10<1:25:15,  4.53s/it]










 47%|████████████████████████████████████████▏                                             | 980/2100 [1:13:55<1:24:27,  4.52s/it]










 47%|████████████████████████████████████████▌                                             | 990/2100 [1:14:40<1:23:42,  4.52s/it]










 48%|████████████████████████████████████████▍                                            | 1000/2100 [1:15:25<1:22:57,  4.52s/it]









 48%|████████████████████████████████████████▊                                            | 1009/2100 [1:16:06<1:22:16,  4.53s/it]











 49%|█████████████████████████████████████████▎                                           | 1020/2100 [1:16:56<1:21:26,  4.52s/it]










 49%|█████████████████████████████████████████▋                                           | 1030/2100 [1:17:41<1:20:41,  4.52s/it]










 50%|██████████████████████████████████████████                                           | 1040/2100 [1:18:26<1:19:55,  4.52s/it]










 50%|██████████████████████████████████████████▌                                          | 1050/2100 [1:19:12<1:19:11,  4.52s/it]









 50%|██████████████████████████████████████████▊                                          | 1059/2100 [1:19:52<1:18:29,  4.52s/it]











 51%|███████████████████████████████████████████▎                                         | 1070/2100 [1:20:42<1:17:40,  4.52s/it]










 51%|███████████████████████████████████████████▋                                         | 1080/2100 [1:21:27<1:16:55,  4.53s/it]










 52%|████████████████████████████████████████████                                         | 1090/2100 [1:22:13<1:16:10,  4.53s/it]










 52%|████████████████████████████████████████████▌                                        | 1100/2100 [1:22:58<1:15:24,  4.52s/it]









 53%|████████████████████████████████████████████▉                                        | 1109/2100 [1:23:39<1:14:44,  4.53s/it]











 53%|█████████████████████████████████████████████▎                                       | 1120/2100 [1:24:28<1:13:54,  4.52s/it]










 54%|█████████████████████████████████████████████▋                                       | 1130/2100 [1:25:14<1:13:09,  4.53s/it]










 54%|██████████████████████████████████████████████▏                                      | 1140/2100 [1:25:59<1:12:24,  4.53s/it]










 55%|██████████████████████████████████████████████▌                                      | 1150/2100 [1:26:44<1:11:38,  4.53s/it]









 55%|██████████████████████████████████████████████▉                                      | 1159/2100 [1:27:25<1:10:57,  4.52s/it]











 56%|███████████████████████████████████████████████▎                                     | 1170/2100 [1:28:15<1:10:07,  4.52s/it]









 56%|███████████████████████████████████████████████▋                                     | 1179/2100 [1:28:55<1:09:27,  4.53s/it]










 57%|████████████████████████████████████████████████▏                                    | 1189/2100 [1:29:41<1:08:42,  4.53s/it]










 57%|████████████████████████████████████████████████▌                                    | 1199/2100 [1:30:26<1:07:56,  4.52s/it]










 58%|████████████████████████████████████████████████▉                                    | 1209/2100 [1:31:11<1:07:11,  4.53s/it]










 58%|█████████████████████████████████████████████████▎                                   | 1219/2100 [1:31:56<1:06:26,  4.53s/it]










 59%|█████████████████████████████████████████████████▋                                   | 1229/2100 [1:32:42<1:05:41,  4.52s/it]










 59%|██████████████████████████████████████████████████▏                                  | 1239/2100 [1:33:27<1:04:56,  4.53s/it]










 59%|██████████████████████████████████████████████████▌                                  | 1249/2100 [1:34:12<1:04:11,  4.53s/it]










 60%|██████████████████████████████████████████████████▉                                  | 1259/2100 [1:34:57<1:03:25,  4.53s/it]










 60%|███████████████████████████████████████████████████▎                                 | 1269/2100 [1:35:43<1:02:40,  4.52s/it]










 61%|███████████████████████████████████████████████████▊                                 | 1279/2100 [1:36:28<1:01:55,  4.53s/it]










 61%|████████████████████████████████████████████████████▏                                | 1289/2100 [1:37:13<1:01:10,  4.53s/it]










 62%|████████████████████████████████████████████████████▌                                | 1299/2100 [1:37:58<1:00:24,  4.53s/it]











 62%|██████████████████████████████████████████████████████▎                                | 1310/2100 [1:38:48<59:35,  4.53s/it]










 63%|██████████████████████████████████████████████████████▋                                | 1320/2100 [1:39:33<58:49,  4.53s/it]










 63%|███████████████████████████████████████████████████████                                | 1330/2100 [1:40:19<58:04,  4.53s/it]










 64%|███████████████████████████████████████████████████████▌                               | 1340/2100 [1:41:04<57:18,  4.52s/it]









 64%|███████████████████████████████████████████████████████▉                               | 1349/2100 [1:41:45<56:38,  4.53s/it]










 65%|████████████████████████████████████████████████████████▎                              | 1359/2100 [1:42:30<55:53,  4.52s/it]










 65%|████████████████████████████████████████████████████████▋                              | 1369/2100 [1:43:15<55:07,  4.53s/it]










 66%|█████████████████████████████████████████████████████████▏                             | 1379/2100 [1:44:00<54:22,  4.52s/it]










 66%|█████████████████████████████████████████████████████████▌                             | 1389/2100 [1:44:46<53:37,  4.53s/it]










 67%|█████████████████████████████████████████████████████████▉                             | 1399/2100 [1:45:31<52:51,  4.52s/it]
{'loss': 2.81, 'learning_rate': 0.0016666666666666666, 'epoch': 3.91}
 67%|██████████████████████████████████████████████████████████                             | 1400/2100 [1:45:35<52:47,  4.53s/it][INFO|configuration_utils.py:458] 2024-01-24 15:50:04,953 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-1400/config.json
[INFO|configuration_utils.py:364] 2024-01-24 15:50:04,953 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-1400/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-24 15:50:04,959 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-1400/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-24 15:50:04,959 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-1400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-24 15:50:04,959 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-1400/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(








 67%|██████████████████████████████████████████████████████████▎                            | 1409/2100 [1:46:16<52:07,  4.53s/it]










 68%|██████████████████████████████████████████████████████████▊                            | 1419/2100 [1:47:01<51:21,  4.53s/it]










 68%|███████████████████████████████████████████████████████████▏                           | 1429/2100 [1:47:47<50:36,  4.53s/it]










 69%|███████████████████████████████████████████████████████████▌                           | 1439/2100 [1:48:32<49:51,  4.53s/it]










 69%|████████████████████████████████████████████████████████████                           | 1449/2100 [1:49:17<49:05,  4.52s/it]










 69%|████████████████████████████████████████████████████████████▍                          | 1459/2100 [1:50:02<48:20,  4.53s/it]










 70%|████████████████████████████████████████████████████████████▊                          | 1469/2100 [1:50:48<47:35,  4.53s/it]










 70%|█████████████████████████████████████████████████████████████▎                         | 1479/2100 [1:51:33<46:49,  4.52s/it]










 71%|█████████████████████████████████████████████████████████████▋                         | 1489/2100 [1:52:18<46:04,  4.52s/it]










 71%|██████████████████████████████████████████████████████████████                         | 1499/2100 [1:53:03<45:19,  4.52s/it]










 72%|██████████████████████████████████████████████████████████████▌                        | 1509/2100 [1:53:49<44:34,  4.52s/it]










 72%|██████████████████████████████████████████████████████████████▉                        | 1519/2100 [1:54:34<43:48,  4.52s/it]










 73%|███████████████████████████████████████████████████████████████▎                       | 1529/2100 [1:55:19<43:03,  4.53s/it]










 73%|███████████████████████████████████████████████████████████████▊                       | 1539/2100 [1:56:04<42:18,  4.52s/it]










 74%|████████████████████████████████████████████████████████████████▏                      | 1549/2100 [1:56:50<41:33,  4.53s/it]










 74%|████████████████████████████████████████████████████████████████▌                      | 1559/2100 [1:57:35<40:48,  4.53s/it]










 75%|█████████████████████████████████████████████████████████████████                      | 1569/2100 [1:58:20<40:02,  4.53s/it]










 75%|█████████████████████████████████████████████████████████████████▍                     | 1579/2100 [1:59:05<39:17,  4.53s/it]










 76%|█████████████████████████████████████████████████████████████████▊                     | 1589/2100 [1:59:51<38:32,  4.53s/it]










 76%|██████████████████████████████████████████████████████████████████▏                    | 1599/2100 [2:00:36<37:46,  4.52s/it]










 77%|██████████████████████████████████████████████████████████████████▋                    | 1609/2100 [2:01:21<37:01,  4.52s/it]










 77%|███████████████████████████████████████████████████████████████████                    | 1619/2100 [2:02:06<36:16,  4.52s/it]










 78%|███████████████████████████████████████████████████████████████████▍                   | 1629/2100 [2:02:52<35:31,  4.52s/it]










 78%|███████████████████████████████████████████████████████████████████▉                   | 1639/2100 [2:03:37<34:45,  4.52s/it]










 79%|████████████████████████████████████████████████████████████████████▎                  | 1649/2100 [2:04:22<34:00,  4.53s/it]










 79%|████████████████████████████████████████████████████████████████████▋                  | 1659/2100 [2:05:07<33:15,  4.52s/it]










 79%|█████████████████████████████████████████████████████████████████████▏                 | 1669/2100 [2:05:53<32:30,  4.52s/it]










 80%|█████████████████████████████████████████████████████████████████████▌                 | 1679/2100 [2:06:38<31:45,  4.53s/it]










 80%|█████████████████████████████████████████████████████████████████████▉                 | 1689/2100 [2:07:23<31:00,  4.53s/it]










 81%|██████████████████████████████████████████████████████████████████████▍                | 1699/2100 [2:08:08<30:15,  4.53s/it]










 81%|██████████████████████████████████████████████████████████████████████▊                | 1709/2100 [2:08:54<29:30,  4.53s/it]










 82%|███████████████████████████████████████████████████████████████████████▏               | 1719/2100 [2:09:39<28:44,  4.53s/it]










 82%|███████████████████████████████████████████████████████████████████████▋               | 1729/2100 [2:10:24<27:59,  4.53s/it]










 83%|████████████████████████████████████████████████████████████████████████               | 1739/2100 [2:11:10<27:14,  4.53s/it]










 83%|████████████████████████████████████████████████████████████████████████▍              | 1749/2100 [2:11:55<26:28,  4.53s/it]










 84%|████████████████████████████████████████████████████████████████████████▊              | 1759/2100 [2:12:40<25:43,  4.53s/it]











 84%|█████████████████████████████████████████████████████████████████████████▎             | 1770/2100 [2:13:30<24:53,  4.53s/it]









 85%|█████████████████████████████████████████████████████████████████████████▋             | 1779/2100 [2:14:11<24:13,  4.53s/it]










 85%|██████████████████████████████████████████████████████████████████████████             | 1789/2100 [2:14:56<23:27,  4.53s/it]











 86%|██████████████████████████████████████████████████████████████████████████▌            | 1800/2100 [2:15:46<22:37,  4.53s/it]









 86%|██████████████████████████████████████████████████████████████████████████▉            | 1809/2100 [2:16:26<21:56,  4.53s/it]











 87%|███████████████████████████████████████████████████████████████████████████▍           | 1820/2100 [2:17:16<21:07,  4.53s/it]









 87%|███████████████████████████████████████████████████████████████████████████▊           | 1829/2100 [2:17:57<20:26,  4.52s/it]










 88%|████████████████████████████████████████████████████████████████████████████▏          | 1839/2100 [2:18:42<19:40,  4.52s/it]










 88%|████████████████████████████████████████████████████████████████████████████▌          | 1849/2100 [2:19:27<18:55,  4.52s/it]










 89%|█████████████████████████████████████████████████████████████████████████████          | 1859/2100 [2:20:13<18:10,  4.53s/it]











 89%|█████████████████████████████████████████████████████████████████████████████▍         | 1870/2100 [2:21:02<17:20,  4.53s/it]









 89%|█████████████████████████████████████████████████████████████████████████████▊         | 1879/2100 [2:21:43<16:40,  4.53s/it]










 90%|██████████████████████████████████████████████████████████████████████████████▎        | 1889/2100 [2:22:28<15:54,  4.53s/it]











 90%|██████████████████████████████████████████████████████████████████████████████▋        | 1900/2100 [2:23:18<15:05,  4.53s/it]









 91%|███████████████████████████████████████████████████████████████████████████████        | 1909/2100 [2:23:59<14:24,  4.52s/it]











 91%|███████████████████████████████████████████████████████████████████████████████▌       | 1920/2100 [2:24:49<13:34,  4.52s/it]









 92%|███████████████████████████████████████████████████████████████████████████████▉       | 1929/2100 [2:25:29<12:53,  4.52s/it]










 92%|████████████████████████████████████████████████████████████████████████████████▎      | 1939/2100 [2:26:15<12:08,  4.52s/it]











 93%|████████████████████████████████████████████████████████████████████████████████▊      | 1950/2100 [2:27:04<11:18,  4.52s/it]









 93%|█████████████████████████████████████████████████████████████████████████████████▏     | 1959/2100 [2:27:45<10:38,  4.52s/it]











 94%|█████████████████████████████████████████████████████████████████████████████████▌     | 1970/2100 [2:28:35<09:48,  4.53s/it]









 94%|█████████████████████████████████████████████████████████████████████████████████▉     | 1979/2100 [2:29:16<09:07,  4.52s/it]










 95%|██████████████████████████████████████████████████████████████████████████████████▍    | 1989/2100 [2:30:01<08:22,  4.53s/it]











 95%|██████████████████████████████████████████████████████████████████████████████████▊    | 2000/2100 [2:30:51<07:32,  4.52s/it]









 96%|███████████████████████████████████████████████████████████████████████████████████▏   | 2009/2100 [2:31:31<06:51,  4.52s/it]











 96%|███████████████████████████████████████████████████████████████████████████████████▋   | 2020/2100 [2:32:21<06:02,  4.53s/it]









 97%|████████████████████████████████████████████████████████████████████████████████████   | 2029/2100 [2:33:02<05:21,  4.52s/it]










 97%|████████████████████████████████████████████████████████████████████████████████████▍  | 2039/2100 [2:33:47<04:35,  4.52s/it]











 98%|████████████████████████████████████████████████████████████████████████████████████▉  | 2050/2100 [2:34:37<03:46,  4.53s/it]









 98%|█████████████████████████████████████████████████████████████████████████████████████▎ | 2059/2100 [2:35:18<03:05,  4.53s/it]










 99%|█████████████████████████████████████████████████████████████████████████████████████▋ | 2069/2100 [2:36:03<02:20,  4.53s/it]










 99%|██████████████████████████████████████████████████████████████████████████████████████▏| 2079/2100 [2:36:48<01:35,  4.53s/it]










 99%|██████████████████████████████████████████████████████████████████████████████████████▌| 2089/2100 [2:37:33<00:49,  4.53s/it]










100%|██████████████████████████████████████████████████████████████████████████████████████▉| 2099/2100 [2:38:19<00:04,  4.53s/it]
{'loss': 2.9194, 'learning_rate': 0.0, 'epoch': 5.87}
Saving PrefixEncoder
{'train_runtime': 9503.7392, 'train_samples_per_second': 3.535, 'train_steps_per_second': 0.221, 'train_loss': 2.806431107293992, 'epoch': 5.87}
***** train metrics *****
  epoch                    =       5.87
  train_loss               =     2.8064
  train_runtime            = 2:38:23.73
  train_samples            =       5725
  train_samples_per_second =      3.535
  train_steps_per_second   =      0.221
100%|███████████████████████████████████████████████████████████████████████████████████████| 2100/2100 [2:38:23<00:00,  4.53s/it][INFO|configuration_utils.py:458] 2024-01-24 16:42:52,764 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-2100/config.json
[INFO|configuration_utils.py:364] 2024-01-24 16:42:52,765 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-2100/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-24 16:42:52,771 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-2100/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-24 16:42:52,771 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-2100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-24 16:42:52,771 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-5e-3/checkpoint-2100/special_tokens_map.json
[INFO|trainer.py:2053] 2024-01-24 16:42:52,787 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|███████████████████████████████████████████████████████████████████████████████████████| 2100/2100 [2:38:23<00:00,  4.53s/it]
[INFO|trainer.py:3200] 2024-01-24 16:42:52,791 >> ***** Running Evaluation *****
[INFO|trainer.py:3202] 2024-01-24 16:42:52,791 >>   Num examples = 315
[INFO|trainer.py:3205] 2024-01-24 16:42:52,791 >>   Batch size = 4
[INFO|configuration_utils.py:577] 2024-01-24 16:42:52,792 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  0%|                                                                                                      | 0/79 [00:00<?, ?it/s][INFO|configuration_utils.py:577] 2024-01-24 16:43:08,229 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  3%|██▍                                                                                           | 2/79 [00:15<09:49,  7.65s/it][INFO|configuration_utils.py:577] 2024-01-24 16:43:23,538 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  4%|███▌                                                                                          | 3/79 [00:30<13:44, 10.84s/it][INFO|configuration_utils.py:577] 2024-01-24 16:43:38,846 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  5%|████▊                                                                                         | 4/79 [00:45<15:38, 12.51s/it][INFO|configuration_utils.py:577] 2024-01-24 16:43:54,153 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  6%|█████▉                                                                                        | 5/79 [01:01<16:37, 13.48s/it][INFO|configuration_utils.py:577] 2024-01-24 16:44:09,466 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  8%|███████▏                                                                                      | 6/79 [01:16<17:08, 14.09s/it][INFO|configuration_utils.py:577] 2024-01-24 16:44:24,777 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
  9%|████████▎                                                                                     | 7/79 [01:31<17:22, 14.48s/it][INFO|configuration_utils.py:577] 2024-01-24 16:44:40,087 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 10%|█████████▌                                                                                    | 8/79 [01:47<17:26, 14.74s/it][INFO|configuration_utils.py:577] 2024-01-24 16:44:55,395 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 11%|██████████▋                                                                                   | 9/79 [02:02<17:24, 14.92s/it][INFO|configuration_utils.py:577] 2024-01-24 16:45:10,714 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 13%|███████████▊                                                                                 | 10/79 [02:17<17:17, 15.04s/it][INFO|configuration_utils.py:577] 2024-01-24 16:45:26,022 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 14%|████████████▉                                                                                | 11/79 [02:33<17:08, 15.12s/it][INFO|configuration_utils.py:577] 2024-01-24 16:45:41,334 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 15%|██████████████▏                                                                              | 12/79 [02:48<16:57, 15.18s/it][INFO|configuration_utils.py:577] 2024-01-24 16:45:56,648 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 16%|███████████████▎                                                                             | 13/79 [03:03<16:44, 15.22s/it][INFO|configuration_utils.py:577] 2024-01-24 16:46:11,959 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 18%|████████████████▍                                                                            | 14/79 [03:19<16:31, 15.25s/it][INFO|configuration_utils.py:577] 2024-01-24 16:46:27,268 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 19%|█████████████████▋                                                                           | 15/79 [03:34<16:16, 15.26s/it][INFO|configuration_utils.py:577] 2024-01-24 16:46:42,572 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 20%|██████████████████▊                                                                          | 16/79 [03:49<16:02, 15.28s/it][INFO|configuration_utils.py:577] 2024-01-24 16:46:57,878 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 22%|████████████████████                                                                         | 17/79 [03:54<12:32, 12.13s/it][INFO|configuration_utils.py:577] 2024-01-24 16:47:02,691 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 23%|█████████████████████▏                                                                       | 18/79 [04:09<13:18, 13.09s/it][INFO|configuration_utils.py:577] 2024-01-24 16:47:17,999 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 24%|██████████████████████▎                                                                      | 19/79 [04:25<13:45, 13.75s/it][INFO|configuration_utils.py:577] 2024-01-24 16:47:33,308 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 25%|███████████████████████▌                                                                     | 20/79 [04:40<13:58, 14.22s/it][INFO|configuration_utils.py:577] 2024-01-24 16:47:48,616 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 27%|████████████████████████▋                                                                    | 21/79 [04:55<14:03, 14.55s/it][INFO|configuration_utils.py:577] 2024-01-24 16:48:03,924 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 28%|█████████████████████████▉                                                                   | 22/79 [05:11<14:02, 14.77s/it][INFO|configuration_utils.py:577] 2024-01-24 16:48:19,230 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 29%|███████████████████████████                                                                  | 23/79 [05:26<13:56, 14.93s/it][INFO|configuration_utils.py:577] 2024-01-24 16:48:34,535 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 30%|████████████████████████████▎                                                                | 24/79 [05:41<13:47, 15.05s/it][INFO|configuration_utils.py:577] 2024-01-24 16:48:49,842 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 32%|█████████████████████████████▍                                                               | 25/79 [05:56<13:36, 15.12s/it][INFO|configuration_utils.py:577] 2024-01-24 16:49:05,149 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 33%|██████████████████████████████▌                                                              | 26/79 [06:12<13:24, 15.18s/it][INFO|configuration_utils.py:577] 2024-01-24 16:49:20,456 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 34%|███████████████████████████████▊                                                             | 27/79 [06:27<13:11, 15.22s/it][INFO|configuration_utils.py:577] 2024-01-24 16:49:35,767 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 35%|████████████████████████████████▉                                                            | 28/79 [06:42<12:57, 15.25s/it][INFO|configuration_utils.py:577] 2024-01-24 16:49:51,074 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 37%|██████████████████████████████████▏                                                          | 29/79 [06:58<12:43, 15.26s/it][INFO|configuration_utils.py:577] 2024-01-24 16:50:06,383 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 38%|███████████████████████████████████▎                                                         | 30/79 [07:13<12:28, 15.28s/it][INFO|configuration_utils.py:577] 2024-01-24 16:50:21,690 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 39%|████████████████████████████████████▍                                                        | 31/79 [07:28<12:13, 15.29s/it][INFO|configuration_utils.py:577] 2024-01-24 16:50:36,996 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 41%|█████████████████████████████████████▋                                                       | 32/79 [07:44<11:58, 15.29s/it][INFO|configuration_utils.py:577] 2024-01-24 16:50:52,303 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 42%|██████████████████████████████████████▊                                                      | 33/79 [07:59<11:43, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:51:07,610 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 43%|████████████████████████████████████████                                                     | 34/79 [08:14<11:28, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:51:22,917 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 44%|█████████████████████████████████████████▏                                                   | 35/79 [08:29<11:13, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:51:38,223 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 46%|██████████████████████████████████████████▍                                                  | 36/79 [08:35<08:55, 12.46s/it][INFO|configuration_utils.py:577] 2024-01-24 16:51:44,048 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 47%|███████████████████████████████████████████▌                                                 | 37/79 [08:51<09:19, 13.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:51:59,356 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 48%|████████████████████████████████████████████▋                                                | 38/79 [09:06<09:30, 13.91s/it][INFO|configuration_utils.py:577] 2024-01-24 16:52:14,662 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 49%|█████████████████████████████████████████████▉                                               | 39/79 [09:21<09:33, 14.33s/it][INFO|configuration_utils.py:577] 2024-01-24 16:52:29,970 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 51%|███████████████████████████████████████████████                                              | 40/79 [09:37<09:30, 14.62s/it][INFO|configuration_utils.py:577] 2024-01-24 16:52:45,277 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 52%|████████████████████████████████████████████████▎                                            | 41/79 [09:52<09:23, 14.83s/it][INFO|configuration_utils.py:577] 2024-01-24 16:53:00,584 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 53%|█████████████████████████████████████████████████▍                                           | 42/79 [10:07<09:13, 14.97s/it][INFO|configuration_utils.py:577] 2024-01-24 16:53:15,888 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 54%|██████████████████████████████████████████████████▌                                          | 43/79 [10:22<09:02, 15.07s/it][INFO|configuration_utils.py:577] 2024-01-24 16:53:31,191 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 56%|███████████████████████████████████████████████████▊                                         | 44/79 [10:38<08:49, 15.14s/it][INFO|configuration_utils.py:577] 2024-01-24 16:53:46,497 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 57%|████████████████████████████████████████████████████▉                                        | 45/79 [10:53<08:36, 15.19s/it][INFO|configuration_utils.py:577] 2024-01-24 16:54:01,804 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 58%|██████████████████████████████████████████████████████▏                                      | 46/79 [11:08<08:22, 15.23s/it][INFO|configuration_utils.py:577] 2024-01-24 16:54:17,110 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 59%|███████████████████████████████████████████████████████▎                                     | 47/79 [11:24<08:08, 15.25s/it][INFO|configuration_utils.py:577] 2024-01-24 16:54:32,419 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 61%|████████████████████████████████████████████████████████▌                                    | 48/79 [11:39<07:53, 15.27s/it][INFO|configuration_utils.py:577] 2024-01-24 16:54:47,725 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 62%|█████████████████████████████████████████████████████████▋                                   | 49/79 [11:54<07:38, 15.28s/it][INFO|configuration_utils.py:577] 2024-01-24 16:55:03,032 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 63%|██████████████████████████████████████████████████████████▊                                  | 50/79 [12:10<07:23, 15.29s/it][INFO|configuration_utils.py:577] 2024-01-24 16:55:18,339 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 65%|████████████████████████████████████████████████████████████                                 | 51/79 [12:25<07:08, 15.29s/it][INFO|configuration_utils.py:577] 2024-01-24 16:55:33,647 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 66%|█████████████████████████████████████████████████████████████▏                               | 52/79 [12:40<06:53, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:55:48,950 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 67%|██████████████████████████████████████████████████████████████▍                              | 53/79 [12:56<06:37, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:56:04,257 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 68%|███████████████████████████████████████████████████████████████▌                             | 54/79 [13:11<06:22, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:56:19,564 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 70%|████████████████████████████████████████████████████████████████▋                            | 55/79 [13:26<06:07, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:56:34,872 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 71%|█████████████████████████████████████████████████████████████████▉                           | 56/79 [13:41<05:52, 15.30s/it][INFO|configuration_utils.py:577] 2024-01-24 16:56:50,179 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 72%|███████████████████████████████████████████████████████████████████                          | 57/79 [13:57<05:36, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:57:05,485 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 73%|████████████████████████████████████████████████████████████████████▎                        | 58/79 [14:12<05:21, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:57:20,790 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 75%|█████████████████████████████████████████████████████████████████████▍                       | 59/79 [14:27<05:06, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:57:36,097 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 76%|██████████████████████████████████████████████████████████████████████▋                      | 60/79 [14:43<04:50, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:57:51,404 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 77%|███████████████████████████████████████████████████████████████████████▊                     | 61/79 [14:58<04:35, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:58:06,707 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 78%|████████████████████████████████████████████████████████████████████████▉                    | 62/79 [15:13<04:20, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:58:22,016 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 80%|██████████████████████████████████████████████████████████████████████████▏                  | 63/79 [15:29<04:04, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:58:37,326 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 81%|███████████████████████████████████████████████████████████████████████████▎                 | 64/79 [15:44<03:49, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:58:52,635 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 82%|████████████████████████████████████████████████████████████████████████████▌                | 65/79 [15:59<03:34, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:59:07,941 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 84%|█████████████████████████████████████████████████████████████████████████████▋               | 66/79 [16:15<03:18, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:59:23,248 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 85%|██████████████████████████████████████████████████████████████████████████████▊              | 67/79 [16:30<03:03, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:59:38,556 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 86%|████████████████████████████████████████████████████████████████████████████████             | 68/79 [16:45<02:48, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 16:59:53,863 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 87%|█████████████████████████████████████████████████████████████████████████████████▏           | 69/79 [17:00<02:33, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:00:09,169 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 89%|██████████████████████████████████████████████████████████████████████████████████▍          | 70/79 [17:16<02:17, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:00:24,476 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 90%|███████████████████████████████████████████████████████████████████████████████████▌         | 71/79 [17:31<02:02, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:00:39,783 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 91%|████████████████████████████████████████████████████████████████████████████████████▊        | 72/79 [17:46<01:47, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:00:55,088 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 92%|█████████████████████████████████████████████████████████████████████████████████████▉       | 73/79 [18:02<01:31, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:01:10,398 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 94%|███████████████████████████████████████████████████████████████████████████████████████      | 74/79 [18:17<01:16, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:01:25,705 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 95%|████████████████████████████████████████████████████████████████████████████████████████▎    | 75/79 [18:32<01:01, 15.31s/it][INFO|configuration_utils.py:577] 2024-01-24 17:01:41,011 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 96%|█████████████████████████████████████████████████████████████████████████████████████████▍   | 76/79 [18:42<00:40, 13.57s/it][INFO|configuration_utils.py:577] 2024-01-24 17:01:50,525 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 97%|██████████████████████████████████████████████████████████████████████████████████████████▋  | 77/79 [18:57<00:28, 14.09s/it][INFO|configuration_utils.py:577] 2024-01-24 17:02:05,833 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
 99%|███████████████████████████████████████████████████████████████████████████████████████████▊ | 78/79 [19:12<00:14, 14.46s/it][INFO|configuration_utils.py:577] 2024-01-24 17:02:21,140 >> Generate config GenerationConfig {
  "_from_model_config": true,
  "eos_token_id": 2,
  "pad_token_id": 0,
  "transformers_version": "4.30.2"
}
01/24/2024 17:02:36 - DEBUG - jieba - Building prefix dict from the default dictionary ...
01/24/2024 17:02:36 - DEBUG - jieba - Loading model from cache /tmp/jieba.cache
01/24/2024 17:02:37 - DEBUG - jieba - Loading model cost 0.273 seconds.
01/24/2024 17:02:37 - DEBUG - jieba - Prefix dict has been built successfully.
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [19:28<00:00, 14.70s/it]Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.273 seconds.
Prefix dict has been built successfully.
***** eval metrics *****
  epoch                   =       5.87
  eval_bleu-4             =     3.3355
  eval_rouge-1            =    20.3331
  eval_rouge-2            =       4.55
  eval_rouge-l            =     9.9298
  eval_runtime            = 0:19:45.20
  eval_samples            =        315
  eval_samples_per_second =      0.266
  eval_steps_per_second   =      0.067
100%|█████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [19:29<00:00, 14.81s/it]