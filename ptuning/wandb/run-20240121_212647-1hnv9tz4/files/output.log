/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[INFO|trainer.py:1786] 2024-01-21 21:26:51,147 >> ***** Running training *****
[INFO|trainer.py:1787] 2024-01-21 21:26:51,147 >>   Num examples = 5,725
[INFO|trainer.py:1788] 2024-01-21 21:26:51,147 >>   Num Epochs = 9
[INFO|trainer.py:1789] 2024-01-21 21:26:51,147 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:1790] 2024-01-21 21:26:51,147 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:1791] 2024-01-21 21:26:51,147 >>   Gradient Accumulation steps = 16
[INFO|trainer.py:1792] 2024-01-21 21:26:51,147 >>   Total optimization steps = 3,000
[INFO|trainer.py:1793] 2024-01-21 21:26:51,148 >>   Number of trainable parameters = 917,504
[INFO|integrations.py:727] 2024-01-21 21:26:51,176 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|                                                                                                                                                                   | 0/3000 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
01/21/2024 21:26:51 - WARNING - transformers_modules.chatglm2-6b.modeling_chatglm - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...








  0%|▍                                                                                                                                                        | 9/3000 [00:41<3:48:41,  4.59s/it]










  1%|▉                                                                                                                                                       | 19/3000 [01:27<3:47:16,  4.57s/it]










  1%|█▍                                                                                                                                                      | 29/3000 [02:13<3:46:37,  4.58s/it]











  1%|██                                                                                                                                                      | 40/3000 [03:03<3:45:32,  4.57s/it]









  2%|██▍                                                                                                                                                     | 49/3000 [03:44<3:45:06,  4.58s/it]










  2%|██▉                                                                                                                                                     | 59/3000 [04:30<3:44:26,  4.58s/it]










  2%|███▍                                                                                                                                                    | 69/3000 [05:15<3:40:15,  4.51s/it]










  3%|████                                                                                                                                                    | 79/3000 [06:00<3:39:11,  4.50s/it]










  3%|████▌                                                                                                                                                   | 89/3000 [06:46<3:38:24,  4.50s/it]










  3%|█████                                                                                                                                                   | 99/3000 [07:31<3:39:22,  4.54s/it]










  4%|█████▍                                                                                                                                                 | 109/3000 [08:16<3:37:02,  4.50s/it]










  4%|█████▉                                                                                                                                                 | 119/3000 [09:01<3:36:12,  4.50s/it]










  4%|██████▍                                                                                                                                                | 129/3000 [09:46<3:35:30,  4.50s/it]










  5%|██████▉                                                                                                                                                | 139/3000 [10:31<3:34:39,  4.50s/it]










  5%|███████▍                                                                                                                                               | 149/3000 [11:16<3:33:52,  4.50s/it]










  5%|████████                                                                                                                                               | 159/3000 [12:01<3:33:06,  4.50s/it]










  6%|████████▌                                                                                                                                              | 169/3000 [12:46<3:32:24,  4.50s/it]










  6%|█████████                                                                                                                                              | 179/3000 [13:31<3:31:38,  4.50s/it]










  6%|█████████▌                                                                                                                                             | 189/3000 [14:16<3:30:52,  4.50s/it]










  7%|██████████                                                                                                                                             | 199/3000 [15:01<3:30:09,  4.50s/it]










  7%|██████████▌                                                                                                                                            | 209/3000 [15:46<3:29:22,  4.50s/it]










  7%|███████████                                                                                                                                            | 219/3000 [16:31<3:28:37,  4.50s/it]










  8%|███████████▌                                                                                                                                           | 229/3000 [17:16<3:27:51,  4.50s/it]










  8%|████████████                                                                                                                                           | 239/3000 [18:01<3:27:06,  4.50s/it]










  8%|████████████▌                                                                                                                                          | 249/3000 [18:46<3:26:21,  4.50s/it]










  9%|█████████████                                                                                                                                          | 259/3000 [19:31<3:25:37,  4.50s/it]










  9%|█████████████▌                                                                                                                                         | 269/3000 [20:16<3:24:53,  4.50s/it]










  9%|██████████████                                                                                                                                         | 279/3000 [21:01<3:24:07,  4.50s/it]










 10%|██████████████▌                                                                                                                                        | 289/3000 [21:46<3:23:21,  4.50s/it]










 10%|███████████████                                                                                                                                        | 299/3000 [22:31<3:22:37,  4.50s/it]










 10%|███████████████▌                                                                                                                                       | 309/3000 [23:16<3:21:51,  4.50s/it]










 11%|████████████████                                                                                                                                       | 319/3000 [24:01<3:21:06,  4.50s/it]










 11%|████████████████▌                                                                                                                                      | 329/3000 [24:46<3:20:13,  4.50s/it]










 11%|█████████████████                                                                                                                                      | 339/3000 [25:31<3:19:27,  4.50s/it]










 12%|█████████████████▌                                                                                                                                     | 349/3000 [26:16<3:18:44,  4.50s/it]










 12%|██████████████████                                                                                                                                     | 359/3000 [27:01<3:18:00,  4.50s/it]










 12%|██████████████████▌                                                                                                                                    | 369/3000 [27:46<3:17:14,  4.50s/it]










 13%|███████████████████                                                                                                                                    | 379/3000 [28:31<3:16:31,  4.50s/it]










 13%|███████████████████▌                                                                                                                                   | 389/3000 [29:16<3:15:48,  4.50s/it]










 13%|████████████████████                                                                                                                                   | 399/3000 [30:01<3:15:02,  4.50s/it]










 14%|████████████████████▌                                                                                                                                  | 409/3000 [30:46<3:14:19,  4.50s/it]










 14%|█████████████████████                                                                                                                                  | 419/3000 [31:31<3:13:33,  4.50s/it]










 14%|█████████████████████▌                                                                                                                                 | 429/3000 [32:16<3:12:48,  4.50s/it]










 15%|██████████████████████                                                                                                                                 | 439/3000 [33:01<3:12:02,  4.50s/it]










 15%|██████████████████████▌                                                                                                                                | 449/3000 [33:46<3:11:18,  4.50s/it]










 15%|███████████████████████                                                                                                                                | 459/3000 [34:31<3:10:33,  4.50s/it]










 16%|███████████████████████▌                                                                                                                               | 469/3000 [35:16<3:09:49,  4.50s/it]











 16%|████████████████████████▏                                                                                                                              | 480/3000 [36:05<3:08:58,  4.50s/it]









 16%|████████████████████████▌                                                                                                                              | 489/3000 [36:46<3:08:19,  4.50s/it]










 17%|█████████████████████████                                                                                                                              | 499/3000 [37:31<3:07:32,  4.50s/it]










 17%|█████████████████████████▌                                                                                                                             | 509/3000 [38:16<3:06:48,  4.50s/it]










 17%|██████████████████████████                                                                                                                             | 519/3000 [39:01<3:06:04,  4.50s/it]










 18%|██████████████████████████▋                                                                                                                            | 529/3000 [39:46<3:05:18,  4.50s/it]










 18%|███████████████████████████▏                                                                                                                           | 539/3000 [40:31<3:04:33,  4.50s/it]










 18%|███████████████████████████▋                                                                                                                           | 549/3000 [41:16<3:05:27,  4.54s/it]










 19%|████████████████████████████▏                                                                                                                          | 559/3000 [42:02<3:06:37,  4.59s/it]










 19%|████████████████████████████▋                                                                                                                          | 569/3000 [42:47<3:04:00,  4.54s/it]











 19%|█████████████████████████████▏                                                                                                                         | 580/3000 [43:38<3:04:13,  4.57s/it]









 20%|█████████████████████████████▋                                                                                                                         | 589/3000 [44:19<3:02:00,  4.53s/it]










 20%|██████████████████████████████▏                                                                                                                        | 599/3000 [45:04<3:01:01,  4.52s/it]










 20%|██████████████████████████████▋                                                                                                                        | 609/3000 [45:49<2:59:19,  4.50s/it]










 21%|███████████████████████████████▏                                                                                                                       | 619/3000 [46:34<2:58:34,  4.50s/it]










 21%|███████████████████████████████▋                                                                                                                       | 629/3000 [47:19<2:57:47,  4.50s/it]










 21%|████████████████████████████████▏                                                                                                                      | 639/3000 [48:04<2:57:04,  4.50s/it]










 22%|████████████████████████████████▋                                                                                                                      | 649/3000 [48:49<2:56:19,  4.50s/it]










 22%|█████████████████████████████████▏                                                                                                                     | 659/3000 [49:34<2:57:16,  4.54s/it]










 22%|█████████████████████████████████▋                                                                                                                     | 669/3000 [50:20<2:59:28,  4.62s/it]










 23%|██████████████████████████████████▏                                                                                                                    | 679/3000 [51:06<2:54:14,  4.50s/it]










 23%|██████████████████████████████████▋                                                                                                                    | 689/3000 [51:51<2:54:25,  4.53s/it]










 23%|███████████████████████████████████▏                                                                                                                   | 699/3000 [52:37<2:54:15,  4.54s/it]











 24%|███████████████████████████████████▋                                                                                                                   | 710/3000 [53:26<2:53:06,  4.54s/it]









 24%|████████████████████████████████████▏                                                                                                                  | 719/3000 [54:07<2:52:43,  4.54s/it]










 24%|████████████████████████████████████▋                                                                                                                  | 729/3000 [54:53<2:52:55,  4.57s/it]










 25%|█████████████████████████████████████▏                                                                                                                 | 739/3000 [55:38<2:50:44,  4.53s/it]











 25%|█████████████████████████████████████▊                                                                                                                 | 750/3000 [56:28<2:50:09,  4.54s/it]









 25%|██████████████████████████████████████▏                                                                                                                | 759/3000 [57:09<2:50:38,  4.57s/it]










 26%|██████████████████████████████████████▋                                                                                                                | 769/3000 [57:55<2:50:39,  4.59s/it]










 26%|███████████████████████████████████████▏                                                                                                               | 779/3000 [58:40<2:48:06,  4.54s/it]










 26%|███████████████████████████████████████▋                                                                                                               | 789/3000 [59:26<2:47:31,  4.55s/it]










 27%|███████████████████████████████████████▋                                                                                                             | 799/3000 [1:00:11<2:46:15,  4.53s/it]










 27%|████████████████████████████████████████▏                                                                                                            | 809/3000 [1:00:56<2:44:27,  4.50s/it]










 27%|████████████████████████████████████████▋                                                                                                            | 819/3000 [1:01:42<2:44:40,  4.53s/it]










 28%|█████████████████████████████████████████▏                                                                                                           | 829/3000 [1:02:27<2:43:14,  4.51s/it]










 28%|█████████████████████████████████████████▋                                                                                                           | 839/3000 [1:03:12<2:43:17,  4.53s/it]










 28%|██████████████████████████████████████████▏                                                                                                          | 849/3000 [1:03:57<2:41:51,  4.51s/it]










 29%|██████████████████████████████████████████▋                                                                                                          | 859/3000 [1:04:42<2:41:36,  4.53s/it]










 29%|███████████████████████████████████████████▏                                                                                                         | 869/3000 [1:05:28<2:40:18,  4.51s/it]










 29%|███████████████████████████████████████████▋                                                                                                         | 879/3000 [1:06:13<2:39:23,  4.51s/it]










 30%|████████████████████████████████████████████▏                                                                                                        | 889/3000 [1:06:58<2:38:38,  4.51s/it]










 30%|████████████████████████████████████████████▋                                                                                                        | 899/3000 [1:07:43<2:37:53,  4.51s/it]










 30%|█████████████████████████████████████████████▏                                                                                                       | 909/3000 [1:08:28<2:37:09,  4.51s/it]










 31%|█████████████████████████████████████████████▋                                                                                                       | 919/3000 [1:09:13<2:36:23,  4.51s/it]










 31%|██████████████████████████████████████████████▏                                                                                                      | 929/3000 [1:09:58<2:35:37,  4.51s/it]










 31%|██████████████████████████████████████████████▋                                                                                                      | 939/3000 [1:10:43<2:36:17,  4.55s/it]










 32%|███████████████████████████████████████████████▏                                                                                                     | 949/3000 [1:11:29<2:34:58,  4.53s/it]










 32%|███████████████████████████████████████████████▋                                                                                                     | 959/3000 [1:12:14<2:33:04,  4.50s/it]










 32%|████████████████████████████████████████████████▏                                                                                                    | 969/3000 [1:12:59<2:32:17,  4.50s/it]










 33%|████████████████████████████████████████████████▌                                                                                                    | 979/3000 [1:13:44<2:31:31,  4.50s/it]











 33%|█████████████████████████████████████████████████▏                                                                                                   | 990/3000 [1:14:34<2:30:37,  4.50s/it]









 33%|█████████████████████████████████████████████████▌                                                                                                   | 999/3000 [1:15:14<2:29:56,  4.50s/it]
{'loss': 2.9033, 'learning_rate': 0.006666666666666666, 'epoch': 2.79}
 33%|█████████████████████████████████████████████████▎                                                                                                  | 1000/3000 [1:15:19<2:29:52,  4.50s/it][INFO|configuration_utils.py:458] 2024-01-21 22:42:10,197 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-1000/config.json
[INFO|configuration_utils.py:364] 2024-01-21 22:42:10,197 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-1000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-21 22:42:10,201 >> Model weights saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-1000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-21 22:42:10,201 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-21 22:42:10,201 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-1000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(









 34%|█████████████████████████████████████████████████▊                                                                                                  | 1010/3000 [1:16:03<2:29:07,  4.50s/it]









 34%|██████████████████████████████████████████████████▎                                                                                                 | 1019/3000 [1:16:44<2:28:26,  4.50s/it]










 34%|██████████████████████████████████████████████████▊                                                                                                 | 1029/3000 [1:17:29<2:27:40,  4.50s/it]










 35%|███████████████████████████████████████████████████▎                                                                                                | 1039/3000 [1:18:14<2:26:56,  4.50s/it]










 35%|███████████████████████████████████████████████████▊                                                                                                | 1049/3000 [1:18:59<2:26:10,  4.50s/it]










 35%|████████████████████████████████████████████████████▏                                                                                               | 1059/3000 [1:19:44<2:25:22,  4.49s/it]










 36%|████████████████████████████████████████████████████▋                                                                                               | 1069/3000 [1:20:29<2:24:35,  4.49s/it]










 36%|█████████████████████████████████████████████████████▏                                                                                              | 1079/3000 [1:21:14<2:23:51,  4.49s/it]










 36%|█████████████████████████████████████████████████████▋                                                                                              | 1089/3000 [1:21:59<2:23:08,  4.49s/it]











 37%|██████████████████████████████████████████████████████▎                                                                                             | 1100/3000 [1:22:48<2:22:19,  4.49s/it]









 37%|██████████████████████████████████████████████████████▋                                                                                             | 1109/3000 [1:23:28<2:21:39,  4.49s/it]











 37%|███████████████████████████████████████████████████████▎                                                                                            | 1120/3000 [1:24:18<2:20:50,  4.50s/it]









 38%|███████████████████████████████████████████████████████▋                                                                                            | 1129/3000 [1:24:58<2:20:10,  4.49s/it]










 38%|████████████████████████████████████████████████████████▏                                                                                           | 1139/3000 [1:25:43<2:19:26,  4.50s/it]










 38%|████████████████████████████████████████████████████████▋                                                                                           | 1149/3000 [1:26:28<2:18:40,  4.50s/it]










 39%|█████████████████████████████████████████████████████████▏                                                                                          | 1159/3000 [1:27:13<2:17:55,  4.49s/it]










 39%|█████████████████████████████████████████████████████████▋                                                                                          | 1169/3000 [1:27:58<2:17:10,  4.50s/it]










 39%|██████████████████████████████████████████████████████████▏                                                                                         | 1179/3000 [1:28:43<2:16:25,  4.49s/it]











 40%|██████████████████████████████████████████████████████████▋                                                                                         | 1190/3000 [1:29:33<2:15:34,  4.49s/it]









 40%|███████████████████████████████████████████████████████████▏                                                                                        | 1199/3000 [1:30:13<2:14:54,  4.49s/it]











 40%|███████████████████████████████████████████████████████████▋                                                                                        | 1210/3000 [1:31:02<2:14:05,  4.49s/it]









 41%|████████████████████████████████████████████████████████████▏                                                                                       | 1219/3000 [1:31:43<2:13:25,  4.50s/it]










 41%|████████████████████████████████████████████████████████████▋                                                                                       | 1229/3000 [1:32:28<2:12:39,  4.49s/it]










 41%|█████████████████████████████████████████████████████████████                                                                                       | 1239/3000 [1:33:13<2:11:55,  4.50s/it]










 42%|█████████████████████████████████████████████████████████████▌                                                                                      | 1249/3000 [1:33:58<2:11:10,  4.49s/it]










 42%|██████████████████████████████████████████████████████████████                                                                                      | 1259/3000 [1:34:43<2:10:26,  4.50s/it]










 42%|██████████████████████████████████████████████████████████████▌                                                                                     | 1269/3000 [1:35:28<2:09:41,  4.50s/it]










 43%|███████████████████████████████████████████████████████████████                                                                                     | 1279/3000 [1:36:13<2:08:55,  4.49s/it]










 43%|███████████████████████████████████████████████████████████████▌                                                                                    | 1289/3000 [1:36:58<2:08:10,  4.49s/it]











 43%|████████████████████████████████████████████████████████████████▏                                                                                   | 1300/3000 [1:37:47<2:07:21,  4.50s/it]









 44%|████████████████████████████████████████████████████████████████▌                                                                                   | 1309/3000 [1:38:27<2:06:40,  4.49s/it]











 44%|█████████████████████████████████████████████████████████████████                                                                                   | 1320/3000 [1:39:17<2:05:52,  4.50s/it]









 44%|█████████████████████████████████████████████████████████████████▌                                                                                  | 1329/3000 [1:39:57<2:05:10,  4.49s/it]










 45%|██████████████████████████████████████████████████████████████████                                                                                  | 1339/3000 [1:40:42<2:04:26,  4.49s/it]










 45%|██████████████████████████████████████████████████████████████████▌                                                                                 | 1349/3000 [1:41:27<2:03:42,  4.50s/it]










 45%|███████████████████████████████████████████████████████████████████                                                                                 | 1359/3000 [1:42:12<2:02:56,  4.50s/it]










 46%|███████████████████████████████████████████████████████████████████▌                                                                                | 1369/3000 [1:42:57<2:02:11,  4.50s/it]










 46%|████████████████████████████████████████████████████████████████████                                                                                | 1379/3000 [1:43:42<2:01:27,  4.50s/it]










 46%|████████████████████████████████████████████████████████████████████▌                                                                               | 1389/3000 [1:44:27<2:00:41,  4.49s/it]










 47%|█████████████████████████████████████████████████████████████████████                                                                               | 1399/3000 [1:45:12<1:59:57,  4.50s/it]










 47%|█████████████████████████████████████████████████████████████████████▌                                                                              | 1409/3000 [1:45:57<1:59:14,  4.50s/it]










 47%|██████████████████████████████████████████████████████████████████████                                                                              | 1419/3000 [1:46:42<1:58:30,  4.50s/it]










 48%|██████████████████████████████████████████████████████████████████████▍                                                                             | 1429/3000 [1:47:27<1:57:44,  4.50s/it]










 48%|██████████████████████████████████████████████████████████████████████▉                                                                             | 1439/3000 [1:48:12<1:57:00,  4.50s/it]










 48%|███████████████████████████████████████████████████████████████████████▍                                                                            | 1449/3000 [1:48:57<1:56:14,  4.50s/it]










 49%|███████████████████████████████████████████████████████████████████████▉                                                                            | 1459/3000 [1:49:42<1:55:28,  4.50s/it]










 49%|████████████████████████████████████████████████████████████████████████▍                                                                           | 1469/3000 [1:50:27<1:54:43,  4.50s/it]










 49%|████████████████████████████████████████████████████████████████████████▉                                                                           | 1479/3000 [1:51:12<1:53:59,  4.50s/it]










 50%|█████████████████████████████████████████████████████████████████████████▍                                                                          | 1489/3000 [1:51:57<1:53:13,  4.50s/it]










 50%|█████████████████████████████████████████████████████████████████████████▉                                                                          | 1499/3000 [1:52:42<1:52:28,  4.50s/it]










 50%|██████████████████████████████████████████████████████████████████████████▍                                                                         | 1509/3000 [1:53:27<1:51:43,  4.50s/it]










 51%|██████████████████████████████████████████████████████████████████████████▉                                                                         | 1519/3000 [1:54:12<1:50:57,  4.50s/it]










 51%|███████████████████████████████████████████████████████████████████████████▍                                                                        | 1529/3000 [1:54:57<1:50:12,  4.50s/it]










 51%|███████████████████████████████████████████████████████████████████████████▉                                                                        | 1539/3000 [1:55:42<1:49:28,  4.50s/it]










 52%|████████████████████████████████████████████████████████████████████████████▍                                                                       | 1549/3000 [1:56:26<1:48:42,  4.50s/it]











 52%|████████████████████████████████████████████████████████████████████████████▉                                                                       | 1560/3000 [1:57:16<1:47:54,  4.50s/it]









 52%|█████████████████████████████████████████████████████████████████████████████▍                                                                      | 1569/3000 [1:57:56<1:47:13,  4.50s/it]










 53%|█████████████████████████████████████████████████████████████████████████████▉                                                                      | 1579/3000 [1:58:41<1:46:28,  4.50s/it]










 53%|██████████████████████████████████████████████████████████████████████████████▍                                                                     | 1589/3000 [1:59:26<1:45:43,  4.50s/it]











 53%|██████████████████████████████████████████████████████████████████████████████▉                                                                     | 1600/3000 [2:00:16<1:44:54,  4.50s/it]









 54%|███████████████████████████████████████████████████████████████████████████████▍                                                                    | 1609/3000 [2:00:56<1:44:12,  4.50s/it]










 54%|███████████████████████████████████████████████████████████████████████████████▊                                                                    | 1619/3000 [2:01:41<1:43:28,  4.50s/it]










 54%|████████████████████████████████████████████████████████████████████████████████▎                                                                   | 1629/3000 [2:02:26<1:42:42,  4.50s/it]










 55%|████████████████████████████████████████████████████████████████████████████████▊                                                                   | 1639/3000 [2:03:11<1:41:56,  4.49s/it]










 55%|█████████████████████████████████████████████████████████████████████████████████▎                                                                  | 1649/3000 [2:03:56<1:41:12,  4.50s/it]










 55%|█████████████████████████████████████████████████████████████████████████████████▊                                                                  | 1659/3000 [2:04:41<1:40:27,  4.50s/it]











 56%|██████████████████████████████████████████████████████████████████████████████████▍                                                                 | 1670/3000 [2:05:30<1:39:38,  4.50s/it]









 56%|██████████████████████████████████████████████████████████████████████████████████▊                                                                 | 1679/3000 [2:06:11<1:38:58,  4.50s/it]











 56%|███████████████████████████████████████████████████████████████████████████████████▎                                                                | 1690/3000 [2:07:00<1:38:08,  4.50s/it]









 57%|███████████████████████████████████████████████████████████████████████████████████▊                                                                | 1699/3000 [2:07:41<1:37:28,  4.50s/it]











 57%|████████████████████████████████████████████████████████████████████████████████████▎                                                               | 1710/3000 [2:08:30<1:36:37,  4.49s/it]









 57%|████████████████████████████████████████████████████████████████████████████████████▊                                                               | 1719/3000 [2:09:11<1:35:57,  4.49s/it]










 58%|█████████████████████████████████████████████████████████████████████████████████████▎                                                              | 1729/3000 [2:09:56<1:35:12,  4.49s/it]










 58%|█████████████████████████████████████████████████████████████████████████████████████▊                                                              | 1739/3000 [2:10:41<1:34:28,  4.50s/it]










 58%|██████████████████████████████████████████████████████████████████████████████████████▎                                                             | 1749/3000 [2:11:26<1:33:43,  4.50s/it]










 59%|██████████████████████████████████████████████████████████████████████████████████████▊                                                             | 1759/3000 [2:12:10<1:32:58,  4.50s/it]










 59%|███████████████████████████████████████████████████████████████████████████████████████▎                                                            | 1769/3000 [2:12:55<1:32:13,  4.50s/it]











 59%|███████████████████████████████████████████████████████████████████████████████████████▊                                                            | 1780/3000 [2:13:45<1:31:24,  4.50s/it]









 60%|████████████████████████████████████████████████████████████████████████████████████████▎                                                           | 1789/3000 [2:14:25<1:30:43,  4.49s/it]











 60%|████████████████████████████████████████████████████████████████████████████████████████▊                                                           | 1800/3000 [2:15:15<1:29:54,  4.50s/it]









 60%|█████████████████████████████████████████████████████████████████████████████████████████▏                                                          | 1809/3000 [2:15:55<1:29:14,  4.50s/it]











 61%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                          | 1820/3000 [2:16:45<1:28:25,  4.50s/it]









 61%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                         | 1829/3000 [2:17:25<1:27:44,  4.50s/it]










 61%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                         | 1839/3000 [2:18:10<1:26:58,  4.50s/it]










 62%|███████████████████████████████████████████████████████████████████████████████████████████▏                                                        | 1849/3000 [2:18:55<1:26:13,  4.50s/it]










 62%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 1859/3000 [2:19:40<1:25:29,  4.50s/it]










 62%|████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 1869/3000 [2:20:25<1:24:44,  4.50s/it]










 63%|████████████████████████████████████████████████████████████████████████████████████████████▋                                                       | 1879/3000 [2:21:10<1:23:59,  4.50s/it]











 63%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                      | 1890/3000 [2:21:59<1:23:09,  4.50s/it]









 63%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                                      | 1899/3000 [2:22:40<1:22:29,  4.50s/it]











 64%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 1910/3000 [2:23:29<1:21:39,  4.50s/it]









 64%|██████████████████████████████████████████████████████████████████████████████████████████████▋                                                     | 1919/3000 [2:24:10<1:20:59,  4.50s/it]











 64%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 1930/3000 [2:24:59<1:20:09,  4.49s/it]









 65%|███████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 1939/3000 [2:25:40<1:19:29,  4.50s/it]











 65%|████████████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 1950/3000 [2:26:29<1:18:40,  4.50s/it]









 65%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                   | 1959/3000 [2:27:10<1:17:59,  4.50s/it]











 66%|█████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 1970/3000 [2:27:59<1:17:10,  4.50s/it]










 66%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                                  | 1980/3000 [2:28:44<1:16:25,  4.50s/it]









 66%|██████████████████████████████████████████████████████████████████████████████████████████████████                                                  | 1989/3000 [2:29:24<1:15:44,  4.49s/it]










 67%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 2000/3000 [2:30:14<1:14:55,  4.50s/it][INFO|configuration_utils.py:458] 2024-01-21 23:57:05,544 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-2000/config.json
[INFO|configuration_utils.py:364] 2024-01-21 23:57:05,544 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-2000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-21 23:57:05,548 >> Model weights saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-2000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-21 23:57:05,548 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-2000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-21 23:57:05,548 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-2000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
{'loss': 6.7729, 'learning_rate': 0.003333333333333333, 'epoch': 5.59}
Saving PrefixEncoder








 67%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                 | 2009/3000 [2:30:54<1:14:14,  4.50s/it]











 67%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                | 2020/3000 [2:31:44<1:13:25,  4.50s/it]









 68%|████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 2029/3000 [2:32:24<1:12:44,  4.50s/it]











 68%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                               | 2040/3000 [2:33:14<1:11:55,  4.50s/it]









 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████                                               | 2049/3000 [2:33:54<1:11:15,  4.50s/it]










 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                              | 2059/3000 [2:34:39<1:10:30,  4.50s/it]










 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                              | 2069/3000 [2:35:24<1:09:45,  4.50s/it]










 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                             | 2079/3000 [2:36:09<1:08:59,  4.49s/it]











 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                             | 2090/3000 [2:36:58<1:08:10,  4.49s/it]









 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 2099/3000 [2:37:39<1:07:30,  4.50s/it]











 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 2110/3000 [2:38:28<1:06:40,  4.50s/it]









 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 2119/3000 [2:39:09<1:06:00,  4.50s/it]











 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████                                           | 2130/3000 [2:39:58<1:05:10,  4.50s/it]









 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 2139/3000 [2:40:39<1:04:30,  4.50s/it]











 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████                                          | 2150/3000 [2:41:28<1:03:41,  4.50s/it]









 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                         | 2159/3000 [2:42:09<1:03:00,  4.50s/it]










 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 2169/3000 [2:42:54<1:02:15,  4.50s/it]










 73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                        | 2179/3000 [2:43:39<1:01:30,  4.50s/it]










 73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 2189/3000 [2:44:23<1:00:45,  4.50s/it]











 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 2200/3000 [2:45:13<59:56,  4.50s/it]









 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 2209/3000 [2:45:53<59:16,  4.50s/it]











 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                       | 2220/3000 [2:46:43<58:26,  4.50s/it]









 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 2229/3000 [2:47:23<57:45,  4.49s/it]











 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 2240/3000 [2:48:13<56:56,  4.49s/it]









 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                     | 2249/3000 [2:48:53<56:15,  4.50s/it]











 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 2260/3000 [2:49:43<55:26,  4.50s/it]









 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 2269/3000 [2:50:23<54:45,  4.50s/it]










 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                    | 2279/3000 [2:51:08<54:00,  4.49s/it]










 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 2289/3000 [2:51:53<53:15,  4.49s/it]










 77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                   | 2299/3000 [2:52:38<52:31,  4.50s/it]










 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                  | 2309/3000 [2:53:23<51:46,  4.50s/it]










 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 2319/3000 [2:54:08<51:01,  4.50s/it]










 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 2329/3000 [2:54:53<50:16,  4.50s/it]










 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 2339/3000 [2:55:38<49:31,  4.50s/it]











 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 2350/3000 [2:56:27<48:42,  4.50s/it]









 79%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 2359/3000 [2:57:08<48:01,  4.50s/it]










 79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 2369/3000 [2:57:53<47:16,  4.50s/it]










 79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 2379/3000 [2:58:38<46:31,  4.50s/it]










 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              | 2389/3000 [2:59:23<45:46,  4.50s/it]










 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                              | 2399/3000 [3:00:07<45:01,  4.49s/it]










 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 2409/3000 [3:00:52<44:16,  4.50s/it]










 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 2419/3000 [3:01:37<43:31,  4.50s/it]










 81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            | 2429/3000 [3:02:22<42:46,  4.50s/it]










 81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 2439/3000 [3:03:07<42:01,  4.50s/it]










 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                           | 2449/3000 [3:03:52<41:16,  4.50s/it]











 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                           | 2460/3000 [3:04:42<40:27,  4.50s/it]









 82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 2469/3000 [3:05:22<39:46,  4.49s/it]










 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 2479/3000 [3:06:07<39:02,  4.50s/it]










 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 2489/3000 [3:06:52<38:16,  4.50s/it]










 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 2499/3000 [3:07:37<37:32,  4.50s/it]










 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        | 2509/3000 [3:08:22<36:47,  4.50s/it]










 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                        | 2519/3000 [3:09:07<36:01,  4.49s/it]










 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                       | 2529/3000 [3:09:52<35:17,  4.50s/it]










 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 2539/3000 [3:10:37<34:32,  4.50s/it]











 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 2550/3000 [3:11:26<33:43,  4.50s/it]









 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 2559/3000 [3:12:07<33:02,  4.50s/it]











 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 2570/3000 [3:12:56<32:13,  4.50s/it]









 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                     | 2579/3000 [3:13:37<31:32,  4.50s/it]











 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 2590/3000 [3:14:26<30:43,  4.50s/it]









 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                    | 2599/3000 [3:15:07<30:02,  4.50s/it]











 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2610/3000 [3:15:56<29:13,  4.50s/it]









 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 2619/3000 [3:16:36<28:32,  4.50s/it]










 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 2629/3000 [3:17:21<27:47,  4.50s/it]










 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 2639/3000 [3:18:06<27:02,  4.49s/it]










 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 2649/3000 [3:18:51<26:17,  4.49s/it]











 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                 | 2660/3000 [3:19:41<25:28,  4.50s/it]









 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 2669/3000 [3:20:21<24:48,  4.50s/it]











 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 2680/3000 [3:21:11<23:58,  4.50s/it]









 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 2689/3000 [3:21:51<23:18,  4.50s/it]











 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 2700/3000 [3:22:41<22:28,  4.50s/it]









 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 2709/3000 [3:23:21<21:48,  4.50s/it]











 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 2720/3000 [3:24:11<20:58,  4.50s/it]









 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍             | 2729/3000 [3:24:51<20:18,  4.50s/it]










 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 2739/3000 [3:25:36<19:33,  4.50s/it]










 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍            | 2749/3000 [3:26:21<18:48,  4.50s/it]










 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉            | 2759/3000 [3:27:06<18:03,  4.50s/it]











 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 2770/3000 [3:27:55<17:13,  4.50s/it]









 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 2779/3000 [3:28:36<16:33,  4.50s/it]











 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 2790/3000 [3:29:25<15:44,  4.50s/it]









 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 2799/3000 [3:30:06<15:03,  4.50s/it]











 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 2810/3000 [3:30:55<14:14,  4.49s/it]









 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 2819/3000 [3:31:36<13:33,  4.50s/it]











 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 2830/3000 [3:32:25<12:44,  4.50s/it]









 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 2839/3000 [3:33:05<12:03,  4.50s/it]










 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 2849/3000 [3:33:50<11:18,  4.50s/it]











 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 2860/3000 [3:34:40<10:29,  4.49s/it]









 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 2869/3000 [3:35:20<09:48,  4.50s/it]











 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 2880/3000 [3:36:10<08:59,  4.50s/it]









 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 2889/3000 [3:36:50<08:19,  4.50s/it]











 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 2900/3000 [3:37:40<07:29,  4.50s/it]









 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 2909/3000 [3:38:20<06:49,  4.50s/it]











 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 2920/3000 [3:39:10<05:59,  4.50s/it]









 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 2929/3000 [3:39:50<05:19,  4.50s/it]











 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 2940/3000 [3:40:40<04:29,  4.50s/it]









 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 2949/3000 [3:41:20<03:49,  4.50s/it]










 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 2959/3000 [3:42:05<03:04,  4.50s/it]











 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 2970/3000 [3:42:54<02:14,  4.50s/it]









 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 2979/3000 [3:43:35<01:34,  4.50s/it]











100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 2990/3000 [3:44:24<00:44,  4.50s/it]









100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2999/3000 [3:45:05<00:04,  4.50s/it]
{'loss': 7.0765, 'learning_rate': 0.0, 'epoch': 8.38}
Saving PrefixEncoder
{'train_runtime': 13509.8149, 'train_samples_per_second': 3.553, 'train_steps_per_second': 0.222, 'train_loss': 4.739414810180664, 'epoch': 8.38}
***** train metrics *****
  epoch                    =       8.38
  train_loss               =     4.7394
  train_runtime            = 3:45:09.81
  train_samples            =       5725
  train_samples_per_second =      3.553
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3000/3000 [3:45:09<00:00,  4.50s/it][INFO|configuration_utils.py:458] 2024-01-22 01:12:00,949 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-3000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 01:12:00,949 >> Configuration saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-3000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 01:12:00,952 >> Model weights saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-3000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 01:12:00,953 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-3000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 01:12:00,953 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-64-1e-2/checkpoint-3000/special_tokens_map.json
[INFO|trainer.py:2053] 2024-01-22 01:12:00,962 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3000/3000 [3:45:09<00:00,  4.50s/it]
Traceback (most recent call last):
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 444, in <module>
    main()
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 391, in main
    wandb.log("metrics",metrics)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 420, in wrapper
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 371, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 361, in wrapper
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1820, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1590, in _log
    raise ValueError("wandb.log must be passed a dictionary")
ValueError: wandb.log must be passed a dictionary
Traceback (most recent call last):
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 444, in <module>
    main()
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 391, in main
    wandb.log("metrics",metrics)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 420, in wrapper
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 371, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 361, in wrapper
    return func(self, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1820, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1590, in _log
    raise ValueError("wandb.log must be passed a dictionary")
ValueError: wandb.log must be passed a dictionary