
01/22/2024 11:41:00 - WARNING - transformers_modules.chatglm2-6b.modeling_chatglm - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[INFO|trainer.py:1786] 2024-01-22 11:41:00,845 >> ***** Running training *****
[INFO|trainer.py:1787] 2024-01-22 11:41:00,845 >>   Num examples = 5,725
[INFO|trainer.py:1788] 2024-01-22 11:41:00,845 >>   Num Epochs = 9
[INFO|trainer.py:1789] 2024-01-22 11:41:00,845 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:1790] 2024-01-22 11:41:00,845 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:1791] 2024-01-22 11:41:00,845 >>   Gradient Accumulation steps = 16
[INFO|trainer.py:1792] 2024-01-22 11:41:00,845 >>   Total optimization steps = 3,000
[INFO|trainer.py:1793] 2024-01-22 11:41:00,845 >>   Number of trainable parameters = 1,835,008
[INFO|integrations.py:727] 2024-01-22 11:41:00,871 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|                                                                                                    | 0/3000 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(








  0%|▎                                                                                         | 9/3000 [00:41<3:45:49,  4.53s/it]










  1%|▌                                                                                        | 19/3000 [01:26<3:44:29,  4.52s/it]










  1%|▊                                                                                        | 29/3000 [02:11<3:44:04,  4.53s/it]










  1%|█▏                                                                                       | 39/3000 [02:57<3:43:23,  4.53s/it]










  2%|█▍                                                                                       | 49/3000 [03:42<3:42:32,  4.52s/it]










  2%|█▊                                                                                       | 59/3000 [04:27<3:41:46,  4.52s/it]










  2%|██                                                                                       | 69/3000 [05:12<3:41:01,  4.52s/it]










  3%|██▎                                                                                      | 79/3000 [05:58<3:40:15,  4.52s/it]










  3%|██▋                                                                                      | 89/3000 [06:43<3:39:29,  4.52s/it]










  3%|██▉                                                                                      | 99/3000 [07:28<3:38:44,  4.52s/it]










  4%|███▏                                                                                    | 109/3000 [08:13<3:37:58,  4.52s/it]










  4%|███▍                                                                                    | 119/3000 [08:59<3:37:14,  4.52s/it]










  4%|███▊                                                                                    | 129/3000 [09:44<3:36:28,  4.52s/it]










  5%|████                                                                                    | 139/3000 [10:29<3:35:43,  4.52s/it]










  5%|████▎                                                                                   | 149/3000 [11:14<3:34:58,  4.52s/it]










  5%|████▋                                                                                   | 159/3000 [11:59<3:34:13,  4.52s/it]










  6%|████▉                                                                                   | 169/3000 [12:45<3:33:28,  4.52s/it]










  6%|█████▎                                                                                  | 179/3000 [13:30<3:32:43,  4.52s/it]










  6%|█████▌                                                                                  | 189/3000 [14:15<3:31:59,  4.52s/it]










  7%|█████▊                                                                                  | 199/3000 [15:00<3:31:13,  4.52s/it]










  7%|██████▏                                                                                 | 209/3000 [15:46<3:30:27,  4.52s/it]










  7%|██████▍                                                                                 | 219/3000 [16:31<3:29:42,  4.52s/it]










  8%|██████▋                                                                                 | 229/3000 [17:16<3:28:56,  4.52s/it]










  8%|███████                                                                                 | 239/3000 [18:01<3:28:12,  4.52s/it]










  8%|███████▎                                                                                | 249/3000 [18:47<3:27:25,  4.52s/it]










  9%|███████▌                                                                                | 259/3000 [19:32<3:26:41,  4.52s/it]










  9%|███████▉                                                                                | 269/3000 [20:17<3:25:55,  4.52s/it]










  9%|████████▏                                                                               | 279/3000 [21:02<3:25:10,  4.52s/it]










 10%|████████▍                                                                               | 289/3000 [21:48<3:24:26,  4.52s/it]










 10%|████████▊                                                                               | 299/3000 [22:33<3:23:40,  4.52s/it]











 10%|█████████                                                                               | 310/3000 [23:23<3:22:49,  4.52s/it]









 11%|█████████▎                                                                              | 319/3000 [24:03<3:22:07,  4.52s/it]










 11%|█████████▋                                                                              | 329/3000 [24:49<3:21:23,  4.52s/it]










 11%|█████████▉                                                                              | 339/3000 [25:34<3:20:38,  4.52s/it]










 12%|██████████▏                                                                             | 349/3000 [26:19<3:19:53,  4.52s/it]











 12%|██████████▌                                                                             | 360/3000 [27:09<3:19:05,  4.52s/it]









 12%|██████████▊                                                                             | 369/3000 [27:50<3:18:22,  4.52s/it]










 13%|███████████                                                                             | 379/3000 [28:35<3:17:36,  4.52s/it]










 13%|███████████▍                                                                            | 389/3000 [29:20<3:16:51,  4.52s/it]










 13%|███████████▋                                                                            | 399/3000 [30:05<3:16:06,  4.52s/it]











 14%|████████████                                                                            | 410/3000 [30:55<3:15:17,  4.52s/it]









 14%|████████████▎                                                                           | 419/3000 [31:36<3:14:37,  4.52s/it]










 14%|████████████▌                                                                           | 429/3000 [32:21<3:13:52,  4.52s/it]










 15%|████████████▉                                                                           | 439/3000 [33:06<3:13:06,  4.52s/it]










 15%|█████████████▏                                                                          | 449/3000 [33:52<3:12:19,  4.52s/it]











 15%|█████████████▍                                                                          | 460/3000 [34:41<3:11:29,  4.52s/it]









 16%|█████████████▊                                                                          | 469/3000 [35:22<3:10:48,  4.52s/it]










 16%|██████████████                                                                          | 479/3000 [36:07<3:10:02,  4.52s/it]










 16%|██████████████▎                                                                         | 489/3000 [36:52<3:09:19,  4.52s/it]










 17%|██████████████▋                                                                         | 499/3000 [37:38<3:08:34,  4.52s/it]










 17%|██████████████▉                                                                         | 509/3000 [38:23<3:07:48,  4.52s/it]










 17%|███████████████▏                                                                        | 519/3000 [39:08<3:07:02,  4.52s/it]










 18%|███████████████▌                                                                        | 529/3000 [39:53<3:06:16,  4.52s/it]










 18%|███████████████▊                                                                        | 539/3000 [40:39<3:05:33,  4.52s/it]










 18%|████████████████                                                                        | 549/3000 [41:24<3:04:48,  4.52s/it]










 19%|████████████████▍                                                                       | 559/3000 [42:09<3:04:01,  4.52s/it]










 19%|████████████████▋                                                                       | 569/3000 [42:54<3:03:16,  4.52s/it]










 19%|████████████████▉                                                                       | 579/3000 [43:40<3:02:32,  4.52s/it]










 20%|█████████████████▎                                                                      | 589/3000 [44:25<3:01:45,  4.52s/it]










 20%|█████████████████▌                                                                      | 599/3000 [45:10<3:01:01,  4.52s/it]










 20%|█████████████████▊                                                                      | 609/3000 [45:55<3:00:16,  4.52s/it]










 21%|██████████████████▏                                                                     | 619/3000 [46:41<2:59:29,  4.52s/it]










 21%|██████████████████▍                                                                     | 629/3000 [47:26<2:58:45,  4.52s/it]










 21%|██████████████████▋                                                                     | 639/3000 [48:11<2:58:00,  4.52s/it]










 22%|███████████████████                                                                     | 649/3000 [48:56<2:57:15,  4.52s/it]










 22%|███████████████████▎                                                                    | 659/3000 [49:41<2:56:28,  4.52s/it]










 22%|███████████████████▌                                                                    | 669/3000 [50:27<2:55:44,  4.52s/it]











 23%|███████████████████▉                                                                    | 680/3000 [51:16<2:54:52,  4.52s/it]









 23%|████████████████████▏                                                                   | 689/3000 [51:57<2:54:14,  4.52s/it]










 23%|████████████████████▌                                                                   | 699/3000 [52:42<2:53:28,  4.52s/it]










 24%|████████████████████▊                                                                   | 709/3000 [53:28<2:52:44,  4.52s/it]










 24%|█████████████████████                                                                   | 719/3000 [54:13<2:51:57,  4.52s/it]











 24%|█████████████████████▍                                                                  | 730/3000 [55:03<2:51:07,  4.52s/it]









 25%|█████████████████████▋                                                                  | 739/3000 [55:43<2:50:27,  4.52s/it]










 25%|█████████████████████▉                                                                  | 749/3000 [56:29<2:49:41,  4.52s/it]










 25%|██████████████████████▎                                                                 | 759/3000 [57:14<2:48:56,  4.52s/it]










 26%|██████████████████████▌                                                                 | 769/3000 [57:59<2:48:11,  4.52s/it]











 26%|██████████████████████▉                                                                 | 780/3000 [58:49<2:47:22,  4.52s/it]









 26%|███████████████████████▏                                                                | 789/3000 [59:30<2:46:40,  4.52s/it]










 27%|██████████████████████▉                                                               | 799/3000 [1:00:15<2:45:54,  4.52s/it]










 27%|███████████████████████▏                                                              | 809/3000 [1:01:00<2:45:10,  4.52s/it]










 27%|███████████████████████▍                                                              | 819/3000 [1:01:45<2:44:25,  4.52s/it]










 28%|███████████████████████▊                                                              | 829/3000 [1:02:30<2:43:40,  4.52s/it]










 28%|████████████████████████                                                              | 839/3000 [1:03:16<2:42:54,  4.52s/it]










 28%|████████████████████████▎                                                             | 849/3000 [1:04:01<2:42:09,  4.52s/it]










 29%|████████████████████████▌                                                             | 859/3000 [1:04:46<2:41:24,  4.52s/it]










 29%|████████████████████████▉                                                             | 869/3000 [1:05:31<2:40:40,  4.52s/it]










 29%|█████████████████████████▏                                                            | 879/3000 [1:06:17<2:39:54,  4.52s/it]










 30%|█████████████████████████▍                                                            | 889/3000 [1:07:02<2:39:09,  4.52s/it]










 30%|█████████████████████████▊                                                            | 899/3000 [1:07:47<2:38:24,  4.52s/it]











 30%|██████████████████████████                                                            | 910/3000 [1:08:37<2:37:35,  4.52s/it]









 31%|██████████████████████████▎                                                           | 919/3000 [1:09:18<2:36:53,  4.52s/it]










 31%|██████████████████████████▋                                                           | 929/3000 [1:10:03<2:36:08,  4.52s/it]










 31%|██████████████████████████▉                                                           | 939/3000 [1:10:48<2:35:23,  4.52s/it]










 32%|███████████████████████████▏                                                          | 949/3000 [1:11:33<2:34:37,  4.52s/it]










 32%|███████████████████████████▍                                                          | 959/3000 [1:12:19<2:33:50,  4.52s/it]










 32%|███████████████████████████▊                                                          | 969/3000 [1:13:04<2:33:06,  4.52s/it]











 33%|████████████████████████████                                                          | 980/3000 [1:13:54<2:32:17,  4.52s/it]









 33%|████████████████████████████▎                                                         | 989/3000 [1:14:34<2:31:37,  4.52s/it]










 33%|████████████████████████████▋                                                         | 999/3000 [1:15:19<2:30:50,  4.52s/it]
{'loss': 2.634, 'learning_rate': 0.0006666666666666666, 'epoch': 2.79}
 33%|████████████████████████████▎                                                        | 1000/3000 [1:15:24<2:30:46,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-22 12:56:25,394 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 12:56:25,394 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 12:56:25,401 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 12:56:25,401 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 12:56:25,401 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-1000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(








 34%|████████████████████████████▌                                                        | 1009/3000 [1:16:05<2:30:05,  4.52s/it]










 34%|████████████████████████████▊                                                        | 1019/3000 [1:16:50<2:29:21,  4.52s/it]











 34%|█████████████████████████████▏                                                       | 1030/3000 [1:17:40<2:28:31,  4.52s/it]









 35%|█████████████████████████████▍                                                       | 1039/3000 [1:18:20<2:27:50,  4.52s/it]










 35%|█████████████████████████████▋                                                       | 1049/3000 [1:19:06<2:27:05,  4.52s/it]










 35%|██████████████████████████████                                                       | 1059/3000 [1:19:51<2:26:20,  4.52s/it]










 36%|██████████████████████████████▎                                                      | 1069/3000 [1:20:36<2:25:35,  4.52s/it]











 36%|██████████████████████████████▌                                                      | 1080/3000 [1:21:26<2:24:44,  4.52s/it]









 36%|██████████████████████████████▊                                                      | 1089/3000 [1:22:07<2:24:04,  4.52s/it]










 37%|███████████████████████████████▏                                                     | 1099/3000 [1:22:52<2:23:19,  4.52s/it]










 37%|███████████████████████████████▍                                                     | 1109/3000 [1:23:37<2:22:33,  4.52s/it]










 37%|███████████████████████████████▋                                                     | 1119/3000 [1:24:22<2:21:48,  4.52s/it]











 38%|████████████████████████████████                                                     | 1130/3000 [1:25:12<2:20:58,  4.52s/it]









 38%|████████████████████████████████▎                                                    | 1139/3000 [1:25:53<2:20:17,  4.52s/it]










 38%|████████████████████████████████▌                                                    | 1149/3000 [1:26:38<2:19:31,  4.52s/it]










 39%|████████████████████████████████▊                                                    | 1159/3000 [1:27:23<2:18:47,  4.52s/it]










 39%|█████████████████████████████████                                                    | 1169/3000 [1:28:09<2:18:02,  4.52s/it]











 39%|█████████████████████████████████▍                                                   | 1180/3000 [1:28:58<2:17:12,  4.52s/it]









 40%|█████████████████████████████████▋                                                   | 1189/3000 [1:29:39<2:16:31,  4.52s/it]










 40%|█████████████████████████████████▉                                                   | 1199/3000 [1:30:24<2:15:46,  4.52s/it]










 40%|██████████████████████████████████▎                                                  | 1209/3000 [1:31:09<2:15:01,  4.52s/it]










 41%|██████████████████████████████████▌                                                  | 1219/3000 [1:31:55<2:14:16,  4.52s/it]











 41%|██████████████████████████████████▊                                                  | 1230/3000 [1:32:44<2:13:27,  4.52s/it]









 41%|███████████████████████████████████                                                  | 1239/3000 [1:33:25<2:12:45,  4.52s/it]










 42%|███████████████████████████████████▍                                                 | 1249/3000 [1:34:10<2:12:01,  4.52s/it]










 42%|███████████████████████████████████▋                                                 | 1259/3000 [1:34:56<2:11:15,  4.52s/it]










 42%|███████████████████████████████████▉                                                 | 1269/3000 [1:35:41<2:10:30,  4.52s/it]











 43%|████████████████████████████████████▎                                                | 1280/3000 [1:36:31<2:09:40,  4.52s/it]









 43%|████████████████████████████████████▌                                                | 1289/3000 [1:37:11<2:08:59,  4.52s/it]











 43%|████████████████████████████████████▊                                                | 1300/3000 [1:38:01<2:08:10,  4.52s/it]









 44%|█████████████████████████████████████                                                | 1309/3000 [1:38:42<2:07:29,  4.52s/it]










 44%|█████████████████████████████████████▎                                               | 1319/3000 [1:39:27<2:06:43,  4.52s/it]











 44%|█████████████████████████████████████▋                                               | 1330/3000 [1:40:17<2:05:54,  4.52s/it]









 45%|█████████████████████████████████████▉                                               | 1339/3000 [1:40:58<2:05:13,  4.52s/it]











 45%|██████████████████████████████████████▎                                              | 1350/3000 [1:41:47<2:04:24,  4.52s/it]









 45%|██████████████████████████████████████▌                                              | 1359/3000 [1:42:28<2:03:43,  4.52s/it]










 46%|██████████████████████████████████████▊                                              | 1369/3000 [1:43:13<2:02:58,  4.52s/it]










 46%|███████████████████████████████████████                                              | 1379/3000 [1:43:58<2:02:12,  4.52s/it]










 46%|███████████████████████████████████████▎                                             | 1389/3000 [1:44:44<2:01:27,  4.52s/it]











 47%|███████████████████████████████████████▋                                             | 1400/3000 [1:45:33<2:00:38,  4.52s/it]









 47%|███████████████████████████████████████▉                                             | 1409/3000 [1:46:14<1:59:57,  4.52s/it]










 47%|████████████████████████████████████████▏                                            | 1419/3000 [1:46:59<1:59:12,  4.52s/it]










 48%|████████████████████████████████████████▍                                            | 1429/3000 [1:47:45<1:58:26,  4.52s/it]










 48%|████████████████████████████████████████▊                                            | 1439/3000 [1:48:30<1:57:41,  4.52s/it]











 48%|█████████████████████████████████████████                                            | 1450/3000 [1:49:20<1:56:51,  4.52s/it]









 49%|█████████████████████████████████████████▎                                           | 1459/3000 [1:50:00<1:56:11,  4.52s/it]










 49%|█████████████████████████████████████████▌                                           | 1469/3000 [1:50:46<1:55:26,  4.52s/it]










 49%|█████████████████████████████████████████▉                                           | 1479/3000 [1:51:31<1:54:41,  4.52s/it]










 50%|██████████████████████████████████████████▏                                          | 1489/3000 [1:52:16<1:53:55,  4.52s/it]











 50%|██████████████████████████████████████████▌                                          | 1500/3000 [1:53:06<1:53:06,  4.52s/it]









 50%|██████████████████████████████████████████▊                                          | 1509/3000 [1:53:47<1:52:24,  4.52s/it]










 51%|███████████████████████████████████████████                                          | 1519/3000 [1:54:32<1:51:44,  4.53s/it]










 51%|███████████████████████████████████████████▎                                         | 1529/3000 [1:55:17<1:50:55,  4.52s/it]










 51%|███████████████████████████████████████████▌                                         | 1539/3000 [1:56:02<1:50:10,  4.52s/it]










 52%|███████████████████████████████████████████▉                                         | 1549/3000 [1:56:48<1:49:25,  4.53s/it]










 52%|████████████████████████████████████████████▏                                        | 1559/3000 [1:57:33<1:48:40,  4.52s/it]










 52%|████████████████████████████████████████████▍                                        | 1569/3000 [1:58:18<1:47:54,  4.52s/it]










 53%|████████████████████████████████████████████▋                                        | 1579/3000 [1:59:03<1:47:08,  4.52s/it]










 53%|█████████████████████████████████████████████                                        | 1589/3000 [1:59:49<1:46:24,  4.52s/it]










 53%|█████████████████████████████████████████████▎                                       | 1599/3000 [2:00:34<1:45:38,  4.52s/it]










 54%|█████████████████████████████████████████████▌                                       | 1609/3000 [2:01:19<1:44:53,  4.52s/it]










 54%|█████████████████████████████████████████████▊                                       | 1619/3000 [2:02:04<1:44:09,  4.53s/it]










 54%|██████████████████████████████████████████████▏                                      | 1629/3000 [2:02:50<1:43:24,  4.53s/it]










 55%|██████████████████████████████████████████████▍                                      | 1639/3000 [2:03:35<1:42:38,  4.52s/it]










 55%|██████████████████████████████████████████████▋                                      | 1649/3000 [2:04:20<1:41:52,  4.52s/it]










 55%|███████████████████████████████████████████████                                      | 1659/3000 [2:05:05<1:41:08,  4.53s/it]










 56%|███████████████████████████████████████████████▎                                     | 1669/3000 [2:05:51<1:40:21,  4.52s/it]










 56%|███████████████████████████████████████████████▌                                     | 1679/3000 [2:06:36<1:39:37,  4.52s/it]










 56%|███████████████████████████████████████████████▊                                     | 1689/3000 [2:07:21<1:38:51,  4.52s/it]










 57%|████████████████████████████████████████████████▏                                    | 1699/3000 [2:08:06<1:38:06,  4.52s/it]










 57%|████████████████████████████████████████████████▍                                    | 1709/3000 [2:08:52<1:37:20,  4.52s/it]










 57%|████████████████████████████████████████████████▋                                    | 1719/3000 [2:09:37<1:36:36,  4.52s/it]










 58%|████████████████████████████████████████████████▉                                    | 1729/3000 [2:10:22<1:35:50,  4.52s/it]










 58%|█████████████████████████████████████████████████▎                                   | 1739/3000 [2:11:07<1:35:04,  4.52s/it]










 58%|█████████████████████████████████████████████████▌                                   | 1749/3000 [2:11:53<1:34:19,  4.52s/it]










 59%|█████████████████████████████████████████████████▊                                   | 1759/3000 [2:12:38<1:33:34,  4.52s/it]










 59%|██████████████████████████████████████████████████                                   | 1769/3000 [2:13:23<1:32:48,  4.52s/it]










 59%|██████████████████████████████████████████████████▍                                  | 1779/3000 [2:14:08<1:32:04,  4.52s/it]










 60%|██████████████████████████████████████████████████▋                                  | 1789/3000 [2:14:53<1:31:18,  4.52s/it]










 60%|██████████████████████████████████████████████████▉                                  | 1799/3000 [2:15:39<1:30:35,  4.53s/it]










 60%|███████████████████████████████████████████████████▎                                 | 1809/3000 [2:16:24<1:29:48,  4.52s/it]










 61%|███████████████████████████████████████████████████▌                                 | 1819/3000 [2:17:09<1:29:03,  4.52s/it]










 61%|███████████████████████████████████████████████████▊                                 | 1829/3000 [2:17:55<1:28:22,  4.53s/it]










 61%|████████████████████████████████████████████████████                                 | 1839/3000 [2:18:40<1:27:33,  4.52s/it]










 62%|████████████████████████████████████████████████████▍                                | 1849/3000 [2:19:25<1:26:47,  4.52s/it]










 62%|████████████████████████████████████████████████████▋                                | 1859/3000 [2:20:10<1:26:02,  4.52s/it]










 62%|████████████████████████████████████████████████████▉                                | 1869/3000 [2:20:55<1:25:16,  4.52s/it]










 63%|█████████████████████████████████████████████████████▏                               | 1879/3000 [2:21:41<1:24:32,  4.53s/it]










 63%|█████████████████████████████████████████████████████▌                               | 1889/3000 [2:22:26<1:23:46,  4.52s/it]










 63%|█████████████████████████████████████████████████████▊                               | 1899/3000 [2:23:11<1:23:01,  4.52s/it]










 64%|██████████████████████████████████████████████████████                               | 1909/3000 [2:23:56<1:22:16,  4.52s/it]










 64%|██████████████████████████████████████████████████████▎                              | 1919/3000 [2:24:42<1:21:31,  4.52s/it]










 64%|██████████████████████████████████████████████████████▋                              | 1929/3000 [2:25:27<1:20:46,  4.52s/it]










 65%|██████████████████████████████████████████████████████▉                              | 1939/3000 [2:26:12<1:20:00,  4.52s/it]










 65%|███████████████████████████████████████████████████████▏                             | 1949/3000 [2:26:57<1:19:15,  4.52s/it]










 65%|███████████████████████████████████████████████████████▌                             | 1959/3000 [2:27:43<1:18:29,  4.52s/it]










 66%|███████████████████████████████████████████████████████▊                             | 1969/3000 [2:28:28<1:17:44,  4.52s/it]











 66%|████████████████████████████████████████████████████████                             | 1980/3000 [2:29:18<1:16:54,  4.52s/it]









 66%|████████████████████████████████████████████████████████▎                            | 1989/3000 [2:29:58<1:16:14,  4.52s/it]










 67%|████████████████████████████████████████████████████████▋                            | 1999/3000 [2:30:44<1:15:28,  4.52s/it]
{'loss': 2.7729, 'learning_rate': 0.0003333333333333333, 'epoch': 5.59}
 67%|████████████████████████████████████████████████████████▋                            | 2000/3000 [2:30:48<1:15:23,  4.52s/it][INFO|configuration_utils.py:458] 2024-01-22 14:11:49,570 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/config.json
[INFO|configuration_utils.py:364] 2024-01-22 14:11:49,570 >> Configuration saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/generation_config.json
[INFO|modeling_utils.py:1853] 2024-01-22 14:11:49,577 >> Model weights saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2194] 2024-01-22 14:11:49,577 >> tokenizer config file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2201] 2024-01-22 14:11:49,577 >> Special tokens file saved in output/adgen-chatglm2-6b-pt-128-1e-3/checkpoint-2000/special_tokens_map.json
/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(








 67%|████████████████████████████████████████████████████████▉                            | 2009/3000 [2:31:29<1:14:44,  4.52s/it]










 67%|█████████████████████████████████████████████████████████▏                           | 2019/3000 [2:32:14<1:14:04,  4.53s/it]










 68%|█████████████████████████████████████████████████████████▍                           | 2029/3000 [2:32:59<1:13:15,  4.53s/it]










 68%|█████████████████████████████████████████████████████████▊                           | 2039/3000 [2:33:45<1:12:29,  4.53s/it]










 68%|██████████████████████████████████████████████████████████                           | 2049/3000 [2:34:30<1:11:43,  4.53s/it]










 69%|██████████████████████████████████████████████████████████▎                          | 2059/3000 [2:35:15<1:10:58,  4.53s/it]










 69%|██████████████████████████████████████████████████████████▌                          | 2069/3000 [2:36:00<1:10:12,  4.52s/it]










 69%|██████████████████████████████████████████████████████████▉                          | 2079/3000 [2:36:46<1:09:26,  4.52s/it]










 70%|███████████████████████████████████████████████████████████▏                         | 2089/3000 [2:37:31<1:08:42,  4.52s/it]










 70%|███████████████████████████████████████████████████████████▍                         | 2099/3000 [2:38:16<1:07:56,  4.52s/it]










 70%|███████████████████████████████████████████████████████████▊                         | 2109/3000 [2:39:01<1:07:11,  4.52s/it]










 71%|████████████████████████████████████████████████████████████                         | 2119/3000 [2:39:47<1:06:26,  4.52s/it]










 71%|████████████████████████████████████████████████████████████▎                        | 2129/3000 [2:40:32<1:05:41,  4.53s/it]










 71%|████████████████████████████████████████████████████████████▌                        | 2139/3000 [2:41:17<1:04:55,  4.52s/it]










 72%|████████████████████████████████████████████████████████████▉                        | 2149/3000 [2:42:02<1:04:10,  4.53s/it]










 72%|█████████████████████████████████████████████████████████████▏                       | 2159/3000 [2:42:48<1:03:25,  4.52s/it]










 72%|█████████████████████████████████████████████████████████████▍                       | 2169/3000 [2:43:33<1:02:40,  4.52s/it]










 73%|█████████████████████████████████████████████████████████████▋                       | 2179/3000 [2:44:18<1:01:54,  4.52s/it]










 73%|██████████████████████████████████████████████████████████████                       | 2189/3000 [2:45:03<1:01:09,  4.52s/it]










 73%|██████████████████████████████████████████████████████████████▎                      | 2199/3000 [2:45:49<1:00:25,  4.53s/it]











 74%|████████████████████████████████████████████████████████████████                       | 2210/3000 [2:46:39<59:34,  4.53s/it]









 74%|████████████████████████████████████████████████████████████████▎                      | 2219/3000 [2:47:19<58:53,  4.52s/it]










 74%|████████████████████████████████████████████████████████████████▋                      | 2229/3000 [2:48:05<58:08,  4.52s/it]










 75%|████████████████████████████████████████████████████████████████▉                      | 2239/3000 [2:48:50<57:22,  4.52s/it]










 75%|█████████████████████████████████████████████████████████████████▏                     | 2249/3000 [2:49:35<56:42,  4.53s/it]











 75%|█████████████████████████████████████████████████████████████████▌                     | 2260/3000 [2:50:25<55:50,  4.53s/it]









 76%|█████████████████████████████████████████████████████████████████▊                     | 2269/3000 [2:51:06<55:13,  4.53s/it]










 76%|██████████████████████████████████████████████████████████████████                     | 2279/3000 [2:51:51<54:24,  4.53s/it]










 76%|██████████████████████████████████████████████████████████████████▍                    | 2289/3000 [2:52:36<53:40,  4.53s/it]








 77%|██████████████████████████████████████████████████████████████████▋                    | 2298/3000 [2:53:17<52:57,  4.53s/it]Traceback (most recent call last):
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 448, in <module>
    main()
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 380, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 1645, in train
    return inner_training_loop(
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 1938, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 2770, in training_step
    self.accelerator.backward(loss)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/accelerate/accelerator.py", line 1964, in backward
    loss.backward(**kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 448, in <module>
    main()
  File "/home/ubuntu/Documents/ai/ChatGLM2-6B/ptuning/main.py", line 380, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 1645, in train
    return inner_training_loop(
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 1938, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/transformers/trainer.py", line 2770, in training_step
    self.accelerator.backward(loss)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/accelerate/accelerator.py", line 1964, in backward
    loss.backward(**kwargs)
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/ubuntu/miniconda3/envs/chatglm2/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt